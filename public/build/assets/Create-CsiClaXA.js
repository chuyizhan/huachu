import{d as v,u as w,c as V,o as l,w as n,a as o,b as s,e,h as $,f as d,g as C,k as x,i as p,j as u,n as m,F as q,s as B,t as i,q as b,l as j}from"./app-CwqX47Va.js";import{_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-B--9PGoJ.js";import{_ as f}from"./index-BHV2WZQp.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-BMCTSd5V.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-3hR0coRb.js";import{_ as N,a as S}from"./CardContent.vue_vue_type_script_setup_true_lang-BycRxxhI.js";import{_ as U}from"./CardDescription.vue_vue_type_script_setup_true_lang-DcJs0U-v.js";import{_ as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-SlUoBphN.js";import{_ as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bku6mZ33.js";import{A}from"./arrow-left-Dsn2ZI3T.js";import"./Primitive-GT_ktTbU.js";import"./useForwardExpose-CmX8ti2p.js";import"./usePrimitiveElement-0Sj8yhN2.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-D94a62pg.js";import"./createLucideIcon-DVzQojCg.js";import"./RovingFocusGroup-DQa8zKLb.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-C5W0E7bH.js";import"./VisuallyHidden-DfLTo0Qp.js";import"./index-DBB-Ipl7.js";import"./DialogTitle-D0ekIDF3.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B5N7NCuu.js";import"./shield-DqvPk8JH.js";import"./file-text-Bp9Q8RnT.js";import"./trending-up-DUOvixY1.js";import"./chevron-right-BrNWW5r8.js";const D={class:"py-12"},L={class:"w-full sm:px-6 lg:px-8"},E={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},I={class:"p-6 text-gray-900 dark:text-gray-100"},T={class:"mb-6 flex items-center justify-between"},G={class:"flex items-center gap-4"},H={class:"space-y-2"},J=["value"],K={key:0,class:"text-sm text-red-500"},O={class:"space-y-2"},P={key:0,class:"text-sm text-red-500"},Q={class:"space-y-2"},R={key:0,class:"text-sm text-red-500"},W={class:"space-y-2"},X={key:0,class:"text-sm text-red-500"},Y={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},Z={class:"text-sm text-gray-600 dark:text-gray-400 space-y-1"},h={key:0},ee={class:"font-semibold"},te={key:1},se={class:"font-semibold"},re={class:"flex gap-4"},Se=v({__name:"Create",props:{users:{}},setup(oe){const r=w({user_id:"",type:"earned",points:0,reason:"",metadata:{}}),k=()=>{r.post("/admin/point-transactions",{preserveScroll:!0})},y=()=>{j.visit("/admin/point-transactions")};return(g,t)=>(l(),V(M,null,{default:n(()=>[o(e($),{title:"创建积分交易"}),s("div",D,[s("div",L,[s("div",E,[s("div",I,[s("div",T,[s("div",G,[o(e(f),{variant:"outline",size:"icon",onClick:y},{default:n(()=>[o(e(A),{class:"h-4 w-4"})]),_:1}),t[4]||(t[4]=s("h1",{class:"text-2xl font-semibold"},"创建积分交易",-1))])]),o(e(N),null,{default:n(()=>[o(e(F),null,{default:n(()=>[o(e(z),null,{default:n(()=>t[5]||(t[5]=[d("交易信息",-1)])),_:1,__:[5]}),o(e(U),null,{default:n(()=>t[6]||(t[6]=[d(" 手动创建积分交易，为用户添加或扣除积分 ",-1)])),_:1,__:[6]})]),_:1}),o(e(S),null,{default:n(()=>[s("form",{onSubmit:C(k,["prevent"]),class:"space-y-6"},[s("div",H,[o(e(_),{for:"user_id"},{default:n(()=>t[7]||(t[7]=[d("用户 *",-1)])),_:1,__:[7]}),x(s("select",{id:"user_id","onUpdate:modelValue":t[0]||(t[0]=a=>e(r).user_id=a),required:"",class:m(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":e(r).errors.user_id}])},[t[8]||(t[8]=s("option",{value:""},"选择用户",-1)),(l(!0),p(q,null,B(g.users,a=>(l(),p("option",{key:a.id,value:a.id},i(a.name)+" (@"+i(a.login_name)+") - "+i(a.email),9,J))),128))],2),[[b,e(r).user_id]]),e(r).errors.user_id?(l(),p("p",K,i(e(r).errors.user_id),1)):u("",!0)]),s("div",O,[o(e(_),{for:"type"},{default:n(()=>t[9]||(t[9]=[d("交易类型 *",-1)])),_:1,__:[9]}),x(s("select",{id:"type","onUpdate:modelValue":t[1]||(t[1]=a=>e(r).type=a),required:"",class:m(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":e(r).errors.type}])},t[10]||(t[10]=[s("option",{value:"earned"},"获得 (增加积分)",-1),s("option",{value:"spent"},"消费 (使用积分)",-1),s("option",{value:"deducted"},"扣除 (管理员扣除)",-1)]),2),[[b,e(r).type]]),t[11]||(t[11]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 获得会增加用户积分，消费和扣除会减少用户积分 ",-1)),e(r).errors.type?(l(),p("p",P,i(e(r).errors.type),1)):u("",!0)]),s("div",Q,[o(e(_),{for:"points"},{default:n(()=>t[12]||(t[12]=[d("积分数量 *",-1)])),_:1,__:[12]}),o(e(c),{id:"points",modelValue:e(r).points,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).points=a),modelModifiers:{number:!0},type:"number",required:"",placeholder:"输入积分数量（正数）",class:m({"border-red-500":e(r).errors.points})},null,8,["modelValue","class"]),t[13]||(t[13]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 请输入正数，系统会根据交易类型自动处理正负号 ",-1)),e(r).errors.points?(l(),p("p",R,i(e(r).errors.points),1)):u("",!0)]),s("div",W,[o(e(_),{for:"reason"},{default:n(()=>t[14]||(t[14]=[d("原因 *",-1)])),_:1,__:[14]}),o(e(c),{id:"reason",modelValue:e(r).reason,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).reason=a),type:"text",required:"",placeholder:"例如：manual_adjustment, daily_bonus, admin_reward",class:m({"border-red-500":e(r).errors.reason})},null,8,["modelValue","class"]),t[15]||(t[15]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 简短描述此交易的原因（建议使用英文下划线格式） ",-1)),e(r).errors.reason?(l(),p("p",X,i(e(r).errors.reason),1)):u("",!0)]),t[22]||(t[22]=s("div",{class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},[s("h4",{class:"text-sm font-medium mb-2 text-blue-900 dark:text-blue-100"},"常用原因建议"),s("div",{class:"text-sm text-blue-800 dark:text-blue-200 space-y-1"},[s("p",null,[s("strong",null,"获得："),d(" daily_login, post_created, comment_created, manual_bonus, referral_reward")]),s("p",null,[s("strong",null,"消费："),d(" post_purchase, premium_upgrade, gift_sent")]),s("p",null,[s("strong",null,"扣除："),d(" violation_penalty, spam_deduction, manual_adjustment")])])],-1)),s("div",Y,[t[20]||(t[20]=s("h3",{class:"text-sm font-medium mb-2"},"预览",-1)),s("div",Z,[e(r).user_id?(l(),p("p",h,[t[16]||(t[16]=d(" 用户：",-1)),s("span",ee,i(g.users.find(a=>a.id===parseInt(e(r).user_id))?.name),1)])):u("",!0),s("p",null,[t[17]||(t[17]=d(" 类型：",-1)),s("span",{class:m(["font-semibold",{"text-green-600":e(r).type==="earned","text-blue-600":e(r).type==="spent","text-red-600":e(r).type==="deducted"}])},i(e(r).type==="earned"?"获得":e(r).type==="spent"?"消费":"扣除"),3)]),s("p",null,[t[18]||(t[18]=d(" 积分变化： ",-1)),s("span",{class:m(["font-semibold text-lg",{"text-green-600":e(r).type==="earned","text-red-600":e(r).type==="spent"||e(r).type==="deducted"}])},i(e(r).type==="earned"?"+":"-")+i(Math.abs(e(r).points)),3)]),e(r).reason?(l(),p("p",te,[t[19]||(t[19]=d("原因：",-1)),s("span",se,i(e(r).reason),1)])):u("",!0)])]),s("div",re,[o(e(f),{type:"submit",disabled:e(r).processing},{default:n(()=>[d(i(e(r).processing?"创建中...":"创建交易"),1)]),_:1},8,["disabled"]),o(e(f),{type:"button",variant:"outline",onClick:y},{default:n(()=>t[21]||(t[21]=[d(" 取消 ",-1)])),_:1,__:[21]})])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{Se as default};
