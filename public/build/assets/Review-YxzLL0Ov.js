import{d as L,z as O,r as T,i as c,o as i,a as l,e as s,h as X,w as o,b as e,j as v,t as d,c as p,n as b,f as u,F as k,s as C,l as g}from"./app-omrOMKVL.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-bjNwbGzX.js";import{_}from"./index-DZLll_k7.js";import{_ as S}from"./index-CLrShI-G.js";import{_ as G,a as H,b as $,c as m,d as J,e as f}from"./TableRow.vue_vue_type_script_setup_true_lang-CW8PP_5o.js";import{C as K}from"./clock-BoyAgb9b.js";import{C as j}from"./circle-check-big-B8Dv9554.js";import{C as z}from"./circle-x-BLRl_xD7.js";import{E as M}from"./eye-DAStXF7m.js";import{R as Q}from"./rotate-ccw-BciWhjwL.js";import"./Primitive-CqfJ75Ql.js";import"./useForwardExpose-z2OA6_ay.js";import"./usePrimitiveElement-BnM25tZc.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-DmhzqpeE.js";import"./createLucideIcon-DD0foOWP.js";import"./RovingFocusGroup-DlE2znV6.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-C5W0E7bH.js";import"./VisuallyHidden-y_-ptxJe.js";import"./index-Dbg1u9AM.js";import"./DialogTitle-DpxAaeRA.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-htH7RIcW.js";import"./shield-lZk7-9GN.js";import"./file-text-CZKcEs7-.js";import"./trending-up-8EDjQJTb.js";import"./chevron-right-zHX_yZmE.js";const U={class:"py-12"},W={class:"w-full sm:px-6 lg:px-8"},Y={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},Z={class:"p-6 text-gray-900 dark:text-gray-100"},I={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},ee={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},te={class:"flex items-center justify-between"},re={class:"text-2xl font-bold mt-1"},se={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},ae={class:"flex items-center justify-between"},le={class:"text-2xl font-bold mt-1"},oe={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},ne={class:"flex items-center justify-between"},de={class:"text-2xl font-bold mt-1"},ie={class:"mb-6"},ue={class:"flex items-center justify-between mb-4"},ge={class:"border-b border-gray-200 dark:border-gray-700"},ce={class:"-mb-px flex space-x-8"},ve={key:0,class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},pe=["checked"],me=["checked","onChange"],fe={class:"flex items-center gap-3"},_e=["src"],ye={class:"font-medium"},be={class:"text-xs text-gray-500 dark:text-gray-400"},xe={class:"text-xs text-gray-500 dark:text-gray-400"},ke={class:"text-sm text-gray-600 dark:text-gray-400"},he={key:0,class:"text-sm"},we={class:"text-xs text-gray-500 dark:text-gray-400"},Ce={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Se={class:"flex gap-2"},$e={key:1,class:"text-center py-12 bg-gray-50 dark:bg-gray-700 rounded-lg"},je={key:2,class:"flex justify-center gap-2 mt-6"},et=L({__name:"Review",props:{posts:{},stats:{},currentStatus:{}},setup(B){const h=B;O();const n=T([]);function x(t){g.get("/admin/post-reviews",{status:t},{preserveState:!0,preserveScroll:!0})}function N(t){g.get(`/admin/post-reviews/${t}`)}function P(t){confirm("确认批准这个帖子？")&&g.post(`/admin/post-reviews/${t}/approve`,{},{preserveScroll:!0,onSuccess:()=>{n.value=n.value.filter(r=>r!==t),g.reload({only:["posts","stats"]})}})}function R(t){const r=prompt("请输入拒绝原因：");r&&g.post(`/admin/post-reviews/${t}/reject`,{notes:r},{preserveScroll:!0,onSuccess:()=>{n.value=n.value.filter(a=>a!==t),g.reload({only:["posts","stats"]})}})}function V(){if(n.value.length===0){alert("请选择要批准的帖子");return}confirm(`确认批准 ${n.value.length} 个帖子？`)&&g.post("/admin/post-reviews/batch-approve",{post_ids:n.value},{preserveScroll:!0,onSuccess:()=>{n.value=[],g.reload({only:["posts","stats"]})}})}function D(t){confirm("确认重置审核状态为待审核？")&&g.post(`/admin/post-reviews/${t}/reset`,{},{preserveScroll:!0,onSuccess:()=>{g.reload({only:["posts","stats"]})}})}function E(t){const r=n.value.indexOf(t);r>-1?n.value.splice(r,1):n.value.push(t)}function A(){n.value.length===h.posts.data.length?n.value=[]:n.value=h.posts.data.map(t=>t.id)}function F(t){switch(t){case"pending":return"bg-yellow-500";case"approved":return"bg-green-500";case"rejected":return"bg-red-500";default:return"bg-gray-500"}}function w(t){return t?new Date(t).toLocaleString("zh-CN"):"-"}return(t,r)=>(i(),c(k,null,[l(s(X),{title:"帖子审核管理"}),l(q,null,{default:o(()=>[e("div",U,[e("div",W,[e("div",Y,[e("div",Z,[r[15]||(r[15]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-semibold"},"帖子审核管理"),e("p",{class:"text-gray-600 dark:text-gray-400 mt-2"},"审核和管理用户提交的帖子")],-1)),e("div",I,[e("div",ee,[e("div",te,[e("div",null,[r[3]||(r[3]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"待审核",-1)),e("p",re,d(t.stats.pending),1)]),l(s(K),{class:"h-8 w-8 text-yellow-500"})])]),e("div",se,[e("div",ae,[e("div",null,[r[4]||(r[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"已批准",-1)),e("p",le,d(t.stats.approved),1)]),l(s(j),{class:"h-8 w-8 text-green-500"})])]),e("div",oe,[e("div",ne,[e("div",null,[r[5]||(r[5]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"已拒绝",-1)),e("p",de,d(t.stats.rejected),1)]),l(s(z),{class:"h-8 w-8 text-red-500"})])])]),e("div",ie,[e("div",ue,[e("div",ge,[e("nav",ce,[e("button",{onClick:r[0]||(r[0]=a=>x("pending")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",t.currentStatus==="pending"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 待审核 ("+d(t.stats.pending)+") ",3),e("button",{onClick:r[1]||(r[1]=a=>x("approved")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",t.currentStatus==="approved"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 已批准 ("+d(t.stats.approved)+") ",3),e("button",{onClick:r[2]||(r[2]=a=>x("rejected")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",t.currentStatus==="rejected"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 已拒绝 ("+d(t.stats.rejected)+") ",3)])]),t.currentStatus==="pending"&&n.value.length>0?(i(),p(s(_),{key:0,onClick:V,class:"bg-green-600 hover:bg-green-700 text-white"},{default:o(()=>[u(" 批量批准 ("+d(n.value.length)+") ",1)]),_:1})):v("",!0)])]),t.posts.data.length>0?(i(),c("div",ve,[l(s(G),null,{default:o(()=>[l(s(H),null,{default:o(()=>[l(s($),{class:"bg-gray-50 dark:bg-gray-700"},{default:o(()=>[t.currentStatus==="pending"?(i(),p(s(m),{key:0,class:"w-12"},{default:o(()=>[e("input",{type:"checkbox",checked:n.value.length===t.posts.data.length,onChange:A,class:"rounded border-gray-300 dark:border-gray-600"},null,40,pe)]),_:1})):v("",!0),l(s(m),null,{default:o(()=>r[6]||(r[6]=[u("帖子",-1)])),_:1,__:[6]}),l(s(m),null,{default:o(()=>r[7]||(r[7]=[u("作者",-1)])),_:1,__:[7]}),l(s(m),null,{default:o(()=>r[8]||(r[8]=[u("分类",-1)])),_:1,__:[8]}),l(s(m),null,{default:o(()=>r[9]||(r[9]=[u("媒体",-1)])),_:1,__:[9]}),l(s(m),null,{default:o(()=>r[10]||(r[10]=[u("状态",-1)])),_:1,__:[10]}),l(s(m),null,{default:o(()=>r[11]||(r[11]=[u("审核信息",-1)])),_:1,__:[11]}),l(s(m),null,{default:o(()=>r[12]||(r[12]=[u("操作",-1)])),_:1,__:[12]})]),_:1})]),_:1}),l(s(J),null,{default:o(()=>[(i(!0),c(k,null,C(t.posts.data,a=>(i(),p(s($),{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},{default:o(()=>[t.currentStatus==="pending"?(i(),p(s(f),{key:0},{default:o(()=>[e("input",{type:"checkbox",checked:n.value.includes(a.id),onChange:y=>E(a.id),class:"rounded border-gray-300 dark:border-gray-600"},null,40,me)]),_:2},1024)):v("",!0),l(s(f),null,{default:o(()=>[e("div",fe,[a.first_image?(i(),c("img",{key:0,src:a.first_image,alt:"",class:"w-16 h-16 object-cover rounded"},null,8,_e)):v("",!0),e("div",null,[e("div",ye,d(a.title),1),e("div",be,d(w(a.created_at)),1)])])]),_:2},1024),l(s(f),null,{default:o(()=>[e("div",null,d(a.user.name),1),e("div",xe,d(a.user.email),1)]),_:2},1024),l(s(f),null,{default:o(()=>[l(s(S),{variant:"outline"},{default:o(()=>[u(d(a.category.name),1)]),_:2},1024)]),_:2},1024),l(s(f),null,{default:o(()=>[e("div",ke,[u(d(a.images_count)+" 图片 ",1),r[13]||(r[13]=e("br",null,null,-1)),u(" "+d(a.videos_count)+" 视频 ",1)])]),_:2},1024),l(s(f),null,{default:o(()=>[l(s(S),{class:b(F(a.review_status))},{default:o(()=>[u(d(a.review_status==="pending"?"待审核":a.review_status==="approved"?"已批准":"已拒绝"),1)]),_:2},1032,["class"])]),_:2},1024),l(s(f),null,{default:o(()=>[a.reviewer?(i(),c("div",he,[e("div",null,d(a.reviewer.name),1),e("div",we,d(w(a.reviewed_at)),1)])):(i(),c("div",Ce,"-"))]),_:2},1024),l(s(f),null,{default:o(()=>[e("div",Se,[l(s(_),{size:"sm",variant:"outline",onClick:y=>N(a.id)},{default:o(()=>[l(s(M),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),a.review_status==="pending"?(i(),p(s(_),{key:0,size:"sm",onClick:y=>P(a.id),class:"bg-green-600 hover:bg-green-700 text-white"},{default:o(()=>[l(s(j),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):v("",!0),a.review_status==="pending"?(i(),p(s(_),{key:1,size:"sm",onClick:y=>R(a.id),class:"bg-red-600 hover:bg-red-700 text-white"},{default:o(()=>[l(s(z),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):v("",!0),a.review_status==="rejected"||a.review_status==="approved"?(i(),p(s(_),{key:2,size:"sm",onClick:y=>D(a.id),class:"bg-orange-600 hover:bg-orange-700 text-white",title:"重置为待审核"},{default:o(()=>[l(s(Q),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):v("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):(i(),c("div",$e,r[14]||(r[14]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"没有找到帖子",-1)]))),t.posts.last_page>1?(i(),c("div",je,[(i(!0),c(k,null,C(t.posts.last_page,a=>(i(),p(s(_),{key:a,size:"sm",variant:a===t.posts.current_page?"default":"outline",onClick:y=>s(g).get("/admin/post-reviews",{status:t.currentStatus,page:a})},{default:o(()=>[u(d(a),1)]),_:2},1032,["variant","onClick"]))),128))])):v("",!0)])])])])]),_:1})],64))}});export{et as default};
