import{d as k,u as w,c as V,o as n,w as i,a as o,b as s,e,h as $,f as a,g as C,k as x,i as u,j as p,n as m,F as q,s as B,t as l,q as b,l as j}from"./app-5vuBJxIP.js";import{_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-BTqB89aN.js";import{_ as f}from"./index-dHMXZ2D0.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-DXGNGf9C.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-DyENbi9-.js";import{_ as N,a as S}from"./CardContent.vue_vue_type_script_setup_true_lang-CMaB12Sl.js";import{_ as U}from"./CardDescription.vue_vue_type_script_setup_true_lang-CwBpRejR.js";import{_ as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-DFoKIzTp.js";import{_ as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-DY29sBv5.js";import{A}from"./arrow-left-B--kQIi2.js";import"./Primitive-CpBaQIeB.js";import"./useForwardExpose-DaYmoZpC.js";import"./usePrimitiveElement-XORHKqUh.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-D4z53cSh.js";import"./createLucideIcon-D1_KITvQ.js";import"./RovingFocusGroup-jpvcbDC3.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-C5W0E7bH.js";import"./VisuallyHidden-h1Mw3fu0.js";import"./index-CGS5sLqw.js";import"./DialogTitle-vE8MM9ym.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BLzIWsHT.js";import"./shield-CRKSWpNn.js";import"./file-text-B9uRyuSi.js";import"./trending-up-BLDAI6Bj.js";import"./book-open-BU8zcMTB.js";import"./chevron-right-DxFz3y5n.js";const D={class:"py-12"},L={class:"w-full sm:px-6 lg:px-8"},E={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},I={class:"p-6 text-gray-900 dark:text-gray-100"},T={class:"mb-6 flex items-center justify-between"},G={class:"flex items-center gap-4"},H={class:"space-y-2"},J=["value"],K={key:0,class:"text-sm text-red-500"},O={class:"space-y-2"},P={key:0,class:"text-sm text-red-500"},Q={class:"space-y-2"},R={key:0,class:"text-sm text-red-500"},W={class:"space-y-2"},X={key:0,class:"text-sm text-red-500"},Y={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},Z={class:"text-sm text-gray-600 dark:text-gray-400 space-y-1"},h={key:0},ee={class:"font-semibold"},te={key:1},se={class:"font-semibold"},re={class:"flex gap-4"},Ue=k({__name:"Create",props:{users:{}},setup(oe){const r=w({user_id:"",type:"earned",credits:0,reason:"",metadata:{}}),v=()=>{r.post("/admin/credit-transactions",{preserveScroll:!0})},y=()=>{j.visit("/admin/credit-transactions")};return(g,t)=>(n(),V(M,null,{default:i(()=>[o(e($),{title:"创建金币交易"}),s("div",D,[s("div",L,[s("div",E,[s("div",I,[s("div",T,[s("div",G,[o(e(f),{variant:"outline",size:"icon",onClick:y},{default:i(()=>[o(e(A),{class:"h-4 w-4"})]),_:1}),t[4]||(t[4]=s("h1",{class:"text-2xl font-semibold"},"创建金币交易",-1))])]),o(e(N),null,{default:i(()=>[o(e(F),null,{default:i(()=>[o(e(z),null,{default:i(()=>t[5]||(t[5]=[a("交易信息",-1)])),_:1,__:[5]}),o(e(U),null,{default:i(()=>t[6]||(t[6]=[a(" 手动创建金币交易，为用户添加或扣除金币 ",-1)])),_:1,__:[6]})]),_:1}),o(e(S),null,{default:i(()=>[s("form",{onSubmit:C(v,["prevent"]),class:"space-y-6"},[s("div",H,[o(e(_),{for:"user_id"},{default:i(()=>t[7]||(t[7]=[a("用户 *",-1)])),_:1,__:[7]}),x(s("select",{id:"user_id","onUpdate:modelValue":t[0]||(t[0]=d=>e(r).user_id=d),required:"",class:m(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":e(r).errors.user_id}])},[t[8]||(t[8]=s("option",{value:""},"选择用户",-1)),(n(!0),u(q,null,B(g.users,d=>(n(),u("option",{key:d.id,value:d.id},l(d.name)+" (@"+l(d.login_name)+") - "+l(d.email),9,J))),128))],2),[[b,e(r).user_id]]),e(r).errors.user_id?(n(),u("p",K,l(e(r).errors.user_id),1)):p("",!0)]),s("div",O,[o(e(_),{for:"type"},{default:i(()=>t[9]||(t[9]=[a("交易类型 *",-1)])),_:1,__:[9]}),x(s("select",{id:"type","onUpdate:modelValue":t[1]||(t[1]=d=>e(r).type=d),required:"",class:m(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":e(r).errors.type}])},t[10]||(t[10]=[s("option",{value:"earned"},"获得 (增加金币)",-1),s("option",{value:"spent"},"消费 (使用金币)",-1),s("option",{value:"deducted"},"扣除 (管理员扣除)",-1),s("option",{value:"refunded"},"退款 (退还金币)",-1)]),2),[[b,e(r).type]]),t[11]||(t[11]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 获得会增加用户金币，消费和扣除会减少用户金币 ",-1)),e(r).errors.type?(n(),u("p",P,l(e(r).errors.type),1)):p("",!0)]),s("div",Q,[o(e(_),{for:"credits"},{default:i(()=>t[12]||(t[12]=[a("金币数量 *",-1)])),_:1,__:[12]}),o(e(c),{id:"credits",modelValue:e(r).credits,"onUpdate:modelValue":t[2]||(t[2]=d=>e(r).credits=d),modelModifiers:{number:!0},type:"number",required:"",placeholder:"输入金币数量（正数）",class:m({"border-red-500":e(r).errors.credits})},null,8,["modelValue","class"]),t[13]||(t[13]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 请输入正数，系统会根据交易类型自动处理正负号 ",-1)),e(r).errors.credits?(n(),u("p",R,l(e(r).errors.credits),1)):p("",!0)]),s("div",W,[o(e(_),{for:"reason"},{default:i(()=>t[14]||(t[14]=[a("原因 *",-1)])),_:1,__:[14]}),o(e(c),{id:"reason",modelValue:e(r).reason,"onUpdate:modelValue":t[3]||(t[3]=d=>e(r).reason=d),type:"text",required:"",placeholder:"例如：manual_adjustment, daily_bonus, admin_reward",class:m({"border-red-500":e(r).errors.reason})},null,8,["modelValue","class"]),t[15]||(t[15]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 简短描述此交易的原因（建议使用英文下划线格式） ",-1)),e(r).errors.reason?(n(),u("p",X,l(e(r).errors.reason),1)):p("",!0)]),t[22]||(t[22]=s("div",{class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},[s("h4",{class:"text-sm font-medium mb-2 text-blue-900 dark:text-blue-100"},"常用原因建议"),s("div",{class:"text-sm text-blue-800 dark:text-blue-200 space-y-1"},[s("p",null,[s("strong",null,"获得："),a(" daily_login, post_created, comment_created, manual_bonus, referral_reward")]),s("p",null,[s("strong",null,"消费："),a(" post_purchase, premium_upgrade, gift_sent")]),s("p",null,[s("strong",null,"扣除："),a(" violation_penalty, spam_deduction, manual_adjustment")])])],-1)),s("div",Y,[t[20]||(t[20]=s("h3",{class:"text-sm font-medium mb-2"},"预览",-1)),s("div",Z,[e(r).user_id?(n(),u("p",h,[t[16]||(t[16]=a(" 用户：",-1)),s("span",ee,l(g.users.find(d=>d.id===parseInt(e(r).user_id))?.name),1)])):p("",!0),s("p",null,[t[17]||(t[17]=a(" 类型：",-1)),s("span",{class:m(["font-semibold",{"text-green-600":e(r).type==="earned","text-blue-600":e(r).type==="spent","text-red-600":e(r).type==="deducted"}])},l(e(r).type==="earned"?"获得":e(r).type==="spent"?"消费":"扣除"),3)]),s("p",null,[t[18]||(t[18]=a(" 金币变化： ",-1)),s("span",{class:m(["font-semibold text-lg",{"text-green-600":e(r).type==="earned","text-red-600":e(r).type==="spent"||e(r).type==="deducted"}])},l(e(r).type==="earned"?"+":"-")+l(Math.abs(e(r).credits)),3)]),e(r).reason?(n(),u("p",te,[t[19]||(t[19]=a("原因：",-1)),s("span",se,l(e(r).reason),1)])):p("",!0)])]),s("div",re,[o(e(f),{type:"submit",disabled:e(r).processing},{default:i(()=>[a(l(e(r).processing?"创建中...":"创建交易"),1)]),_:1},8,["disabled"]),o(e(f),{type:"button",variant:"outline",onClick:y},{default:i(()=>t[21]||(t[21]=[a(" 取消 ",-1)])),_:1,__:[21]})])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{Ue as default};
