import{d as j,u as M,r as h,c as R,o as i,w as a,a as l,b as r,e,h as S,f as d,g as z,i as u,j as _,n as g,t as p,k,F,l as N,v as P,m as V,p as D}from"./app-fQ1uHLAv.js";import{_ as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-BJ0FV2gA.js";import{_ as y}from"./index-DOqB-uia.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-491R26qu.js";import{_ as n}from"./Label.vue_vue_type_script_setup_true_lang-D_nXAQgU.js";import{_ as q}from"./Textarea.vue_vue_type_script_setup_true_lang-CDvhHSW8.js";import{_ as A}from"./Card.vue_vue_type_script_setup_true_lang-DP-AvMeC.js";import{_ as O}from"./CardContent.vue_vue_type_script_setup_true_lang-C3RZLHJS.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVUV8WXG.js";import{_ as X}from"./CardHeader.vue_vue_type_script_setup_true_lang-CIB-sEAo.js";import{_ as G}from"./CardTitle.vue_vue_type_script_setup_true_lang-CfvbPLLx.js";import{A as H}from"./arrow-left-BMUb771Y.js";import{X as C}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-DT3FpzxL.js";import"./Primitive-SQ216M94.js";import"./useForwardExpose-_bNHtLbu.js";import"./usePrimitiveElement-BAl1j9Je.js";import"./RovingFocusGroup-Bk8NGMpu.js";import"./VisuallyHidden-BZjHGUhc.js";import"./index-s5yllnis.js";import"./createLucideIcon-5gv4zljX.js";import"./DialogTitle-zHcWgUmM.js";import"./index-hb5zdG9_.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B6bSDjXn.js";import"./shield-DKYKPd_d.js";import"./trending-up-Ua6LM9pt.js";import"./file-text-ByfMAv8n.js";import"./chevron-right-DYder0Ze.js";import"./useArrowNavigation-C6Y-ieo6.js";const J={class:"py-12"},K={class:"w-full sm:px-6 lg:px-8"},Q={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},W={class:"p-6 text-gray-900 dark:text-gray-100"},Y={class:"mb-6 flex items-center justify-between"},Z={class:"flex items-center gap-4"},ee={class:"space-y-2"},se={key:0,class:"text-sm text-red-500"},te={class:"space-y-2"},re={key:0,class:"text-sm text-red-500"},oe={class:"space-y-2"},le={key:0,class:"text-sm text-red-500"},ae={class:"space-y-2"},de=["value"],ie={key:0,class:"text-sm text-red-500"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"space-y-2"},_e={class:"flex gap-2"},ce={key:0,class:"text-sm text-red-500"},pe={class:"space-y-2"},me={key:0,class:"text-sm text-red-500"},ge={class:"space-y-2"},fe={class:"flex items-start gap-4"},ye={key:0,class:"relative"},ve=["src"],xe={class:"flex-1"},be={key:0,class:"text-sm text-red-500 mt-1"},ke={class:"space-y-2"},we={class:"flex items-start gap-4"},he={key:0,class:"relative"},Ve=["src"],Ce={class:"flex-1"},Ue={key:0,class:"text-sm text-red-500 mt-1"},Ie={class:"space-y-2"},$e={key:0,class:"text-sm text-red-500"},Be={class:"flex items-center space-x-2"},Le={class:"space-y-4"},je={class:"flex items-center space-x-2"},Me={key:0,class:"space-y-2 pl-6"},Re={key:0,class:"text-sm text-red-500"},Se={class:"space-y-2"},ze={class:"space-y-2"},Fe={class:"flex items-center space-x-2"},Ne=["checked"],Pe={class:"flex items-center space-x-2"},De=["checked","disabled"],Ee={class:"flex items-center space-x-2"},qe=["checked","disabled"],Ae={class:"flex items-center space-x-2"},Oe=["checked","disabled"],Te={key:0,class:"text-sm text-red-500"},Xe={class:"flex gap-4"},ks=j({__name:"Create",props:{availableParents:{}},setup(Ge){const t=M({name:"",slug:"",description:"",color:"#3b82f6",icon:"",icon_image:null,category_image:null,sort_order:0,is_active:!0,is_nav_item:!1,nav_route:"",allowed_user_types:["all"],parent_id:null}),v=h(null),x=h(null),U=m=>{const o=m.target.files?.[0];o&&(t.icon_image=o,v.value=URL.createObjectURL(o))},I=m=>{const o=m.target.files?.[0];o&&(t.category_image=o,x.value=URL.createObjectURL(o))},$=()=>{t.icon_image=null,v.value=null;const m=document.getElementById("icon_image");m&&(m.value="")},B=()=>{t.category_image=null,x.value=null;const m=document.getElementById("category_image");m&&(m.value="")},L=()=>{t.post("/admin/categories",{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{}})},w=()=>{D.visit("/admin/categories")};return(m,s)=>(i(),R(E,null,{default:a(()=>[l(e(S),{title:"创建分类"}),r("div",J,[r("div",K,[r("div",Q,[r("div",W,[r("div",Y,[r("div",Z,[l(e(y),{variant:"outline",size:"icon",onClick:w},{default:a(()=>[l(e(H),{class:"h-4 w-4"})]),_:1}),s[15]||(s[15]=r("h1",{class:"text-2xl font-semibold"},"创建分类",-1))])]),l(e(A),null,{default:a(()=>[l(e(X),null,{default:a(()=>[l(e(G),null,{default:a(()=>s[16]||(s[16]=[d("分类信息",-1)])),_:1,__:[16]}),l(e(T),null,{default:a(()=>s[17]||(s[17]=[d(" 填写分类的基本信息和设置 ",-1)])),_:1,__:[17]})]),_:1}),l(e(O),null,{default:a(()=>[r("form",{onSubmit:z(L,["prevent"]),class:"space-y-6"},[r("div",ee,[l(e(n),{for:"name"},{default:a(()=>s[18]||(s[18]=[d("分类名称 *",-1)])),_:1,__:[18]}),l(e(f),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=o=>e(t).name=o),type:"text",required:"",class:g({"border-red-500":e(t).errors.name})},null,8,["modelValue","class"]),e(t).errors.name?(i(),u("p",se,p(e(t).errors.name),1)):_("",!0)]),r("div",te,[l(e(n),{for:"slug"},{default:a(()=>s[19]||(s[19]=[d("别名 (URL) *",-1)])),_:1,__:[19]}),l(e(f),{id:"slug",modelValue:e(t).slug,"onUpdate:modelValue":s[1]||(s[1]=o=>e(t).slug=o),type:"text",required:"",placeholder:"category-slug",class:g({"border-red-500":e(t).errors.slug})},null,8,["modelValue","class"]),s[20]||(s[20]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 用于URL的唯一标识符，只能包含小写字母、数字和连字符 ",-1)),e(t).errors.slug?(i(),u("p",re,p(e(t).errors.slug),1)):_("",!0)]),r("div",oe,[l(e(n),{for:"description"},{default:a(()=>s[21]||(s[21]=[d("描述",-1)])),_:1,__:[21]}),l(q,{id:"description",modelValue:e(t).description,"onUpdate:modelValue":s[2]||(s[2]=o=>e(t).description=o),rows:"3",placeholder:"分类描述...",class:g({"border-red-500":e(t).errors.description})},null,8,["modelValue","class"]),e(t).errors.description?(i(),u("p",le,p(e(t).errors.description),1)):_("",!0)]),r("div",ae,[l(e(n),{for:"parent_id"},{default:a(()=>s[22]||(s[22]=[d("父分类",-1)])),_:1,__:[22]}),k(r("select",{id:"parent_id","onUpdate:modelValue":s[3]||(s[3]=o=>e(t).parent_id=o),class:g(["flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-red-500":e(t).errors.parent_id}])},[s[23]||(s[23]=r("option",{value:null},"无 (顶级分类)",-1)),(i(!0),u(F,null,N(m.availableParents,o=>(i(),u("option",{key:o.id,value:o.id},p(o.name),9,de))),128))],2),[[P,e(t).parent_id]]),s[24]||(s[24]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 选择父分类可以创建层级结构。只有没有子分类的分类才能接受帖子。 ",-1)),e(t).errors.parent_id?(i(),u("p",ie,p(e(t).errors.parent_id),1)):_("",!0)]),r("div",ne,[r("div",ue,[l(e(n),{for:"color"},{default:a(()=>s[25]||(s[25]=[d("颜色",-1)])),_:1,__:[25]}),r("div",_e,[l(e(f),{id:"color",modelValue:e(t).color,"onUpdate:modelValue":s[4]||(s[4]=o=>e(t).color=o),type:"color",class:g(["w-20 h-10 p-1 cursor-pointer",{"border-red-500":e(t).errors.color}])},null,8,["modelValue","class"]),l(e(f),{modelValue:e(t).color,"onUpdate:modelValue":s[5]||(s[5]=o=>e(t).color=o),type:"text",placeholder:"#3b82f6",class:g(["flex-1",{"border-red-500":e(t).errors.color}])},null,8,["modelValue","class"])]),e(t).errors.color?(i(),u("p",ce,p(e(t).errors.color),1)):_("",!0)]),r("div",pe,[l(e(n),{for:"icon"},{default:a(()=>s[26]||(s[26]=[d("图标类名",-1)])),_:1,__:[26]}),l(e(f),{id:"icon",modelValue:e(t).icon,"onUpdate:modelValue":s[6]||(s[6]=o=>e(t).icon=o),type:"text",placeholder:"lucide-icon-name",class:g({"border-red-500":e(t).errors.icon})},null,8,["modelValue","class"]),s[27]||(s[27]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 图标类名或标识符 ",-1)),e(t).errors.icon?(i(),u("p",me,p(e(t).errors.icon),1)):_("",!0)])]),r("div",ge,[l(e(n),{for:"icon_image"},{default:a(()=>s[28]||(s[28]=[d("图标图片",-1)])),_:1,__:[28]}),r("div",fe,[v.value?(i(),u("div",ye,[r("img",{src:v.value,alt:"Icon preview",class:"w-24 h-24 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,ve),l(e(y),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:$},{default:a(()=>[l(e(C),{class:"h-4 w-4"})]),_:1})])):_("",!0),r("div",xe,[l(e(f),{id:"icon_image",type:"file",accept:"image/*",onChange:U,class:g({"border-red-500":e(t).errors.icon_image})},null,8,["class"]),s[29]||(s[29]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 200x200px, 最大 2MB ",-1)),e(t).errors.icon_image?(i(),u("p",be,p(e(t).errors.icon_image),1)):_("",!0)])])]),r("div",ke,[l(e(n),{for:"category_image"},{default:a(()=>s[30]||(s[30]=[d("分类封面图",-1)])),_:1,__:[30]}),r("div",we,[x.value?(i(),u("div",he,[r("img",{src:x.value,alt:"Category preview",class:"w-48 h-32 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,Ve),l(e(y),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:B},{default:a(()=>[l(e(C),{class:"h-4 w-4"})]),_:1})])):_("",!0),r("div",Ce,[l(e(f),{id:"category_image",type:"file",accept:"image/*",onChange:I,class:g({"border-red-500":e(t).errors.category_image})},null,8,["class"]),s[31]||(s[31]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 800x600px, 最大 5MB ",-1)),e(t).errors.category_image?(i(),u("p",Ue,p(e(t).errors.category_image),1)):_("",!0)])])]),r("div",Ie,[l(e(n),{for:"sort_order"},{default:a(()=>s[32]||(s[32]=[d("排序顺序",-1)])),_:1,__:[32]}),l(e(f),{id:"sort_order",modelValue:e(t).sort_order,"onUpdate:modelValue":s[7]||(s[7]=o=>e(t).sort_order=o),modelModifiers:{number:!0},type:"number",class:g({"border-red-500":e(t).errors.sort_order})},null,8,["modelValue","class"]),s[33]||(s[33]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 数字越小排序越靠前 ",-1)),e(t).errors.sort_order?(i(),u("p",$e,p(e(t).errors.sort_order),1)):_("",!0)]),r("div",Be,[k(r("input",{id:"is_active","onUpdate:modelValue":s[8]||(s[8]=o=>e(t).is_active=o),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[V,e(t).is_active]]),l(e(n),{for:"is_active",class:"cursor-pointer"},{default:a(()=>s[34]||(s[34]=[d(" 启用分类 ",-1)])),_:1,__:[34]})]),r("div",Le,[r("div",je,[k(r("input",{id:"is_nav_item","onUpdate:modelValue":s[9]||(s[9]=o=>e(t).is_nav_item=o),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[V,e(t).is_nav_item]]),l(e(n),{for:"is_nav_item",class:"cursor-pointer"},{default:a(()=>s[35]||(s[35]=[d(" 显示在导航菜单 ",-1)])),_:1,__:[35]})]),e(t).is_nav_item?(i(),u("div",Me,[l(e(n),{for:"nav_route"},{default:a(()=>s[36]||(s[36]=[d("导航路由",-1)])),_:1,__:[36]}),l(e(f),{id:"nav_route",modelValue:e(t).nav_route,"onUpdate:modelValue":s[10]||(s[10]=o=>e(t).nav_route=o),type:"text",placeholder:"/category/slug",class:g({"border-red-500":e(t).errors.nav_route})},null,8,["modelValue","class"]),s[37]||(s[37]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 导航菜单中的链接地址 ",-1)),e(t).errors.nav_route?(i(),u("p",Re,p(e(t).errors.nav_route),1)):_("",!0)])):_("",!0)]),r("div",Se,[l(e(n),null,{default:a(()=>s[38]||(s[38]=[d("允许发帖的用户类型",-1)])),_:1,__:[38]}),r("div",ze,[r("div",Fe,[r("input",{id:"type_all",type:"checkbox",value:"all",checked:e(t).allowed_user_types.includes("all"),onChange:s[11]||(s[11]=o=>{o.target.checked?e(t).allowed_user_types=["all"]:e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="all")}),class:"rounded"},null,40,Ne),l(e(n),{for:"type_all",class:"cursor-pointer"},{default:a(()=>s[39]||(s[39]=[d("所有用户",-1)])),_:1,__:[39]})]),r("div",Pe,[r("input",{id:"type_creator",type:"checkbox",value:"creator",checked:e(t).allowed_user_types.includes("creator"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[12]||(s[12]=o=>{o.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="all"),e(t).allowed_user_types.push("creator")):e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="creator")}),class:"rounded"},null,40,De),l(e(n),{for:"type_creator",class:"cursor-pointer"},{default:a(()=>s[40]||(s[40]=[d("仅创作者",-1)])),_:1,__:[40]})]),r("div",Ee,[r("input",{id:"type_regular",type:"checkbox",value:"regular",checked:e(t).allowed_user_types.includes("regular"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[13]||(s[13]=o=>{o.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="all"),e(t).allowed_user_types.push("regular")):e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="regular")}),class:"rounded"},null,40,qe),l(e(n),{for:"type_regular",class:"cursor-pointer"},{default:a(()=>s[41]||(s[41]=[d("仅普通用户",-1)])),_:1,__:[41]})]),r("div",Ae,[r("input",{id:"type_admin",type:"checkbox",value:"admin",checked:e(t).allowed_user_types.includes("admin"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[14]||(s[14]=o=>{o.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="all"),e(t).allowed_user_types.push("admin")):e(t).allowed_user_types=e(t).allowed_user_types.filter(c=>c!=="admin")}),class:"rounded"},null,40,Oe),l(e(n),{for:"type_admin",class:"cursor-pointer"},{default:a(()=>s[42]||(s[42]=[d("仅管理员",-1)])),_:1,__:[42]})])]),s[43]||(s[43]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 选择哪些类型的用户可以在此分类下发帖。管理员始终可以发帖。 ",-1)),e(t).errors.allowed_user_types?(i(),u("p",Te,p(e(t).errors.allowed_user_types),1)):_("",!0)]),r("div",Xe,[l(e(y),{type:"submit",disabled:e(t).processing},{default:a(()=>[d(p(e(t).processing?"创建中...":"创建分类"),1)]),_:1},8,["disabled"]),l(e(y),{type:"button",variant:"outline",onClick:w},{default:a(()=>s[44]||(s[44]=[d(" 取消 ",-1)])),_:1,__:[44]})])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{ks as default};
