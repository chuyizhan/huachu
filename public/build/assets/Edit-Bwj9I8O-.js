import{d as S,u as B,l as M,c as q,o as m,w as l,a as o,b as t,e as s,h as N,f as d,g as D,i as f,j as _,n as p,t as n,k as b,q as w,v as x,r as V}from"./app-DnRftP1E.js";import{_ as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-ClAR_mCH.js";import{_ as c}from"./index-Cv03xPye.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang--0Sz4hO5.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-Dyn7XT3i.js";import{_ as j,a as z}from"./CardContent.vue_vue_type_script_setup_true_lang-CUhBzak5.js";import{_ as A}from"./CardDescription.vue_vue_type_script_setup_true_lang-wrK7vxsV.js";import{_ as R}from"./CardHeader.vue_vue_type_script_setup_true_lang-Zglf1tg4.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-0cWuwBXx.js";import{A as I}from"./arrow-left-CTA3ADFh.js";import{R as L}from"./refresh-cw-BpbvKPlQ.js";import"./Primitive-DOETdTZD.js";import"./useForwardExpose-CnpiyQEP.js";import"./usePrimitiveElement-DcRpCK8d.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-BsOM0_VR.js";import"./createLucideIcon-TdDvkylN.js";import"./RovingFocusGroup-DDZ0Xqds.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-C5W0E7bH.js";import"./VisuallyHidden-B06eZ4v2.js";import"./index-CK8AxSVq.js";import"./DialogTitle-BYBbg6Bq.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DLYhm-2B.js";import"./shield-CL4SkSQE.js";import"./file-text-BMhfpiMg.js";import"./trending-up-6UpJwnUn.js";import"./book-open-BSkdM4Pz.js";import"./chevron-right-CxCe42Tv.js";const T={class:"py-12"},G={class:"w-full sm:px-6 lg:px-8"},H={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},J={class:"p-6 text-gray-900 dark:text-gray-100"},K={class:"mb-6 flex items-center justify-between"},O={class:"flex items-center gap-4"},P={class:"space-y-4"},Q={class:"space-y-2"},W={key:0,class:"text-sm text-red-500"},X={class:"space-y-2"},Y={key:0,class:"text-sm text-red-500"},Z={class:"space-y-2"},h={key:0,class:"text-sm text-red-500"},ss={class:"space-y-2"},es={key:0,class:"text-sm text-red-500"},rs={class:"space-y-2"},ts={key:0,class:"text-sm text-red-500"},os={class:"space-y-4 pt-6 border-t"},as={class:"space-y-2"},ls={key:0,class:"text-sm text-red-500"},ds={class:"space-y-2"},is={key:0,class:"text-sm text-red-500"},ns={class:"space-y-2"},us={key:0,class:"text-sm text-red-500"},ms={class:"space-y-2"},ps={key:0,class:"text-sm text-red-500"},fs={class:"space-y-4 pt-6 border-t"},_s={class:"flex items-center space-x-2"},gs={class:"flex items-center space-x-2"},ys={class:"flex items-center space-x-2"},bs={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},cs={class:"text-sm text-gray-600 dark:text-gray-400 space-y-1"},xs={class:"font-semibold"},vs={class:"flex gap-4"},Ws=S({__name:"Edit",props:{user:{}},setup(U){const i=U,r=B({name:i.user.name,email:i.user.email,login_name:i.user.login_name,password:"",password_confirmation:"",is_creator:i.user.is_creator,is_verified:i.user.is_verified,is_top_creator:i.user.is_top_creator,type:i.user.type,status:i.user.status,credits:i.user.credits,balance:i.user.balance}),$=()=>{r.put(`/admin/users/${i.user.id}`,{preserveScroll:!0,onSuccess:()=>{}})},v=()=>{V.visit("/admin/users")},y=M(!1),C=()=>{confirm("确定要根据交易记录重新计算用户的积分和金币余额吗？这将覆盖当前余额。")&&(y.value=!0,V.post(`/admin/users/${i.user.id}/consolidate-balances`,{},{preserveScroll:!0,onSuccess:()=>{y.value=!1},onError:()=>{y.value=!1}}))};return(k,e)=>(m(),q(E,null,{default:l(()=>[o(s(N),{title:`编辑用户 - ${k.user.name}`},null,8,["title"]),t("div",T,[t("div",G,[t("div",H,[t("div",J,[t("div",K,[t("div",O,[o(s(c),{variant:"outline",size:"icon",onClick:v},{default:l(()=>[o(s(I),{class:"h-4 w-4"})]),_:1}),e[12]||(e[12]=t("h1",{class:"text-2xl font-semibold"},"编辑用户",-1))])]),o(s(j),null,{default:l(()=>[o(s(R),null,{default:l(()=>[o(s(F),null,{default:l(()=>e[13]||(e[13]=[d("用户信息",-1)])),_:1,__:[13]}),o(s(A),null,{default:l(()=>e[14]||(e[14]=[d(" 编辑用户的基本信息和权限设置 ",-1)])),_:1,__:[14]})]),_:1}),o(s(z),null,{default:l(()=>[t("form",{onSubmit:D($,["prevent"]),class:"space-y-6"},[t("div",P,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium"},"基本信息",-1)),t("div",Q,[o(s(u),{for:"name"},{default:l(()=>e[15]||(e[15]=[d("姓名 *",-1)])),_:1,__:[15]}),o(s(g),{id:"name",modelValue:s(r).name,"onUpdate:modelValue":e[0]||(e[0]=a=>s(r).name=a),type:"text",required:"",class:p({"border-red-500":s(r).errors.name})},null,8,["modelValue","class"]),s(r).errors.name?(m(),f("p",W,n(s(r).errors.name),1)):_("",!0)]),t("div",X,[o(s(u),{for:"email"},{default:l(()=>e[16]||(e[16]=[d("邮箱 *",-1)])),_:1,__:[16]}),o(s(g),{id:"email",modelValue:s(r).email,"onUpdate:modelValue":e[1]||(e[1]=a=>s(r).email=a),type:"email",required:"",class:p({"border-red-500":s(r).errors.email})},null,8,["modelValue","class"]),s(r).errors.email?(m(),f("p",Y,n(s(r).errors.email),1)):_("",!0)]),t("div",Z,[o(s(u),{for:"login_name"},{default:l(()=>e[17]||(e[17]=[d("用户名 *",-1)])),_:1,__:[17]}),o(s(g),{id:"login_name",modelValue:s(r).login_name,"onUpdate:modelValue":e[2]||(e[2]=a=>s(r).login_name=a),type:"text",required:"",class:p({"border-red-500":s(r).errors.login_name})},null,8,["modelValue","class"]),e[18]||(e[18]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 用于登录的唯一用户名 ",-1)),s(r).errors.login_name?(m(),f("p",h,n(s(r).errors.login_name),1)):_("",!0)]),t("div",ss,[o(s(u),{for:"password"},{default:l(()=>e[19]||(e[19]=[d("新密码",-1)])),_:1,__:[19]}),o(s(g),{id:"password",modelValue:s(r).password,"onUpdate:modelValue":e[3]||(e[3]=a=>s(r).password=a),type:"password",autocomplete:"new-password",class:p({"border-red-500":s(r).errors.password})},null,8,["modelValue","class"]),e[20]||(e[20]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 留空表示不修改密码 ",-1)),s(r).errors.password?(m(),f("p",es,n(s(r).errors.password),1)):_("",!0)]),t("div",rs,[o(s(u),{for:"password_confirmation"},{default:l(()=>e[21]||(e[21]=[d("确认新密码",-1)])),_:1,__:[21]}),o(s(g),{id:"password_confirmation",modelValue:s(r).password_confirmation,"onUpdate:modelValue":e[4]||(e[4]=a=>s(r).password_confirmation=a),type:"password",autocomplete:"new-password",class:p({"border-red-500":s(r).errors.password_confirmation})},null,8,["modelValue","class"]),e[22]||(e[22]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 请再次输入新密码 ",-1)),s(r).errors.password_confirmation?(m(),f("p",ts,n(s(r).errors.password_confirmation),1)):_("",!0)])]),t("div",os,[e[30]||(e[30]=t("h3",{class:"text-lg font-medium"},"账户设置",-1)),t("div",as,[o(s(u),{for:"type"},{default:l(()=>e[24]||(e[24]=[d("用户类型",-1)])),_:1,__:[24]}),b(t("select",{id:"type","onUpdate:modelValue":e[5]||(e[5]=a=>s(r).type=a),class:p(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":s(r).errors.type}])},e[25]||(e[25]=[t("option",{value:1},"普通用户",-1),t("option",{value:2},"高级用户",-1)]),2),[[w,s(r).type,void 0,{number:!0}]]),s(r).errors.type?(m(),f("p",ls,n(s(r).errors.type),1)):_("",!0)]),t("div",ds,[o(s(u),{for:"status"},{default:l(()=>e[26]||(e[26]=[d("账户状态",-1)])),_:1,__:[26]}),b(t("select",{id:"status","onUpdate:modelValue":e[6]||(e[6]=a=>s(r).status=a),class:p(["w-full px-4 py-2 border border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":s(r).errors.status}])},e[27]||(e[27]=[t("option",{value:1},"正常",-1),t("option",{value:2},"暂停",-1),t("option",{value:3},"禁止",-1)]),2),[[w,s(r).status,void 0,{number:!0}]]),s(r).errors.status?(m(),f("p",is,n(s(r).errors.status),1)):_("",!0)]),t("div",ns,[o(s(u),{for:"credits"},{default:l(()=>e[28]||(e[28]=[d("金币余额",-1)])),_:1,__:[28]}),o(s(g),{id:"credits",modelValue:s(r).credits,"onUpdate:modelValue":e[7]||(e[7]=a=>s(r).credits=a),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",class:p({"border-red-500":s(r).errors.credits})},null,8,["modelValue","class"]),s(r).errors.credits?(m(),f("p",us,n(s(r).errors.credits),1)):_("",!0)]),t("div",ms,[o(s(u),{for:"balance"},{default:l(()=>e[29]||(e[29]=[d("积分余额",-1)])),_:1,__:[29]}),o(s(g),{id:"balance",modelValue:s(r).balance,"onUpdate:modelValue":e[8]||(e[8]=a=>s(r).balance=a),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",class:p({"border-red-500":s(r).errors.balance})},null,8,["modelValue","class"]),s(r).errors.balance?(m(),f("p",ps,n(s(r).errors.balance),1)):_("",!0)])]),t("div",fs,[e[34]||(e[34]=t("h3",{class:"text-lg font-medium"},"权限设置",-1)),t("div",_s,[b(t("input",{id:"is_creator","onUpdate:modelValue":e[9]||(e[9]=a=>s(r).is_creator=a),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[x,s(r).is_creator]]),o(s(u),{for:"is_creator",class:"cursor-pointer"},{default:l(()=>e[31]||(e[31]=[d(" 创作者权限 ",-1)])),_:1,__:[31]})]),e[35]||(e[35]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 pl-6"}," 可以发布和管理内容 ",-1)),t("div",gs,[b(t("input",{id:"is_verified","onUpdate:modelValue":e[10]||(e[10]=a=>s(r).is_verified=a),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[x,s(r).is_verified]]),o(s(u),{for:"is_verified",class:"cursor-pointer"},{default:l(()=>e[32]||(e[32]=[d(" 已认证 ",-1)])),_:1,__:[32]})]),e[36]||(e[36]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 pl-6"}," 显示认证标识，表示身份已验证 ",-1)),t("div",ys,[b(t("input",{id:"is_top_creator","onUpdate:modelValue":e[11]||(e[11]=a=>s(r).is_top_creator=a),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[x,s(r).is_top_creator]]),o(s(u),{for:"is_top_creator",class:"cursor-pointer"},{default:l(()=>e[33]||(e[33]=[d(" 顶级创作者 ",-1)])),_:1,__:[33]})]),e[37]||(e[37]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 pl-6"}," 显示特殊标识，表示优质创作者 ",-1))]),t("div",bs,[e[39]||(e[39]=t("h3",{class:"text-sm font-medium mb-2"},"用户信息",-1)),t("div",cs,[t("p",null,[e[38]||(e[38]=d("用户ID: ",-1)),t("span",xs,n(k.user.id),1)])])]),t("div",vs,[o(s(c),{type:"submit",disabled:s(r).processing},{default:l(()=>[d(n(s(r).processing?"保存中...":"保存更改"),1)]),_:1},8,["disabled"]),o(s(c),{type:"button",variant:"outline",onClick:v},{default:l(()=>e[40]||(e[40]=[d(" 取消 ",-1)])),_:1,__:[40]}),o(s(c),{type:"button",variant:"destructive",onClick:C,disabled:y.value},{default:l(()=>[o(s(L),{class:p([{"animate-spin":y.value},"mr-2 h-4 w-4"])},null,8,["class"]),d(" "+n(y.value?"计算中...":"重新计算余额"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{Ws as default};
