import{d as L,z as O,r as R,i as g,o as i,a as l,e as s,h as T,w as n,b as e,j as v,t as d,c as p,n as b,f as u,F as k,s as C,l as f}from"./app-Bs_7LchA.js";import{_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-C9tLp3sR.js";import{_}from"./index-BHo-G5o2.js";import{_ as S}from"./index-C0-M1ZIh.js";import{_ as q,a as G,b as $,c,d as H,e as m}from"./TableRow.vue_vue_type_script_setup_true_lang-DPylJ9aQ.js";import{C as J}from"./clock-Dh41PM0z.js";import{C as j}from"./circle-check-big-B9HsWNCp.js";import{C as z}from"./circle-x-lcQo-iMg.js";import{E as K}from"./eye-DTiFL3HL.js";import"./Primitive-CnJtIoVY.js";import"./useForwardExpose-Bujr0wP8.js";import"./usePrimitiveElement-Bu0XkghR.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-DHAg-Hgh.js";import"./createLucideIcon-qjKXs8nJ.js";import"./RovingFocusGroup-CzC5wnwO.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-C5W0E7bH.js";import"./VisuallyHidden-CMxZK7qQ.js";import"./index-CuNDHsSZ.js";import"./DialogTitle-DeQqFqE2.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B_Nlb4Pc.js";import"./shield-DqLYPG8X.js";import"./file-text-C_VI3-Vb.js";import"./trending-up-DjRlIL1I.js";import"./book-open-BWPi_8lL.js";import"./chevron-right-CN-GgH51.js";const M={class:"py-12"},Q={class:"w-full sm:px-6 lg:px-8"},U={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},W={class:"p-6 text-gray-900 dark:text-gray-100"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Z={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},I={class:"flex items-center justify-between"},ee={class:"text-2xl font-bold mt-1"},te={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},re={class:"flex items-center justify-between"},se={class:"text-2xl font-bold mt-1"},ae={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},le={class:"flex items-center justify-between"},ne={class:"text-2xl font-bold mt-1"},oe={class:"mb-6"},de={class:"flex items-center justify-between mb-4"},ie={class:"border-b border-gray-200 dark:border-gray-700"},ue={class:"-mb-px flex space-x-8"},ge={key:0,class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},ce=["checked"],me=["checked","onChange"],ve={class:"flex items-center gap-3"},pe=["src"],fe={class:"font-medium"},_e={class:"text-xs text-gray-500 dark:text-gray-400"},ye={class:"text-xs text-gray-500 dark:text-gray-400"},be={class:"text-sm text-gray-600 dark:text-gray-400"},xe={key:0,class:"text-sm"},ke={class:"text-xs text-gray-500 dark:text-gray-400"},he={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},we={class:"flex gap-2"},Ce={key:1,class:"text-center py-12 bg-gray-50 dark:bg-gray-700 rounded-lg"},Se={key:2,class:"flex justify-center gap-2 mt-6"},Ze=L({__name:"Review",props:{posts:{},stats:{},currentStatus:{}},setup(B){const h=B;O();const o=R([]);function x(r){f.get("/admin/post-reviews",{status:r},{preserveState:!0,preserveScroll:!0})}function N(r){f.get(`/admin/post-reviews/${r}`)}function P(r){confirm("确认批准这个帖子？")&&f.post(`/admin/post-reviews/${r}/approve`,{},{preserveScroll:!0,onSuccess:()=>{o.value=o.value.filter(t=>t!==r)}})}function V(r){const t=prompt("请输入拒绝原因：");t&&f.post(`/admin/post-reviews/${r}/reject`,{notes:t},{preserveScroll:!0,onSuccess:()=>{o.value=o.value.filter(a=>a!==r)}})}function D(){if(o.value.length===0){alert("请选择要批准的帖子");return}confirm(`确认批准 ${o.value.length} 个帖子？`)&&f.post("/admin/post-reviews/batch-approve",{post_ids:o.value},{preserveScroll:!0,onSuccess:()=>{o.value=[]}})}function E(r){const t=o.value.indexOf(r);t>-1?o.value.splice(t,1):o.value.push(r)}function A(){o.value.length===h.posts.data.length?o.value=[]:o.value=h.posts.data.map(r=>r.id)}function F(r){switch(r){case"pending":return"bg-yellow-500";case"approved":return"bg-green-500";case"rejected":return"bg-red-500";default:return"bg-gray-500"}}function w(r){return r?new Date(r).toLocaleString("zh-CN"):"-"}return(r,t)=>(i(),g(k,null,[l(s(T),{title:"帖子审核管理"}),l(X,null,{default:n(()=>[e("div",M,[e("div",Q,[e("div",U,[e("div",W,[t[15]||(t[15]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-semibold"},"帖子审核管理"),e("p",{class:"text-gray-600 dark:text-gray-400 mt-2"},"审核和管理用户提交的帖子")],-1)),e("div",Y,[e("div",Z,[e("div",I,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"待审核",-1)),e("p",ee,d(r.stats.pending),1)]),l(s(J),{class:"h-8 w-8 text-yellow-500"})])]),e("div",te,[e("div",re,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"已批准",-1)),e("p",se,d(r.stats.approved),1)]),l(s(j),{class:"h-8 w-8 text-green-500"})])]),e("div",ae,[e("div",le,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"已拒绝",-1)),e("p",ne,d(r.stats.rejected),1)]),l(s(z),{class:"h-8 w-8 text-red-500"})])])]),e("div",oe,[e("div",de,[e("div",ie,[e("nav",ue,[e("button",{onClick:t[0]||(t[0]=a=>x("pending")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",r.currentStatus==="pending"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 待审核 ("+d(r.stats.pending)+") ",3),e("button",{onClick:t[1]||(t[1]=a=>x("approved")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",r.currentStatus==="approved"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 已批准 ("+d(r.stats.approved)+") ",3),e("button",{onClick:t[2]||(t[2]=a=>x("rejected")),class:b(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",r.currentStatus==="rejected"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])}," 已拒绝 ("+d(r.stats.rejected)+") ",3)])]),r.currentStatus==="pending"&&o.value.length>0?(i(),p(s(_),{key:0,onClick:D,class:"bg-green-600 hover:bg-green-700 text-white"},{default:n(()=>[u(" 批量批准 ("+d(o.value.length)+") ",1)]),_:1})):v("",!0)])]),r.posts.data.length>0?(i(),g("div",ge,[l(s(q),null,{default:n(()=>[l(s(G),null,{default:n(()=>[l(s($),{class:"bg-gray-50 dark:bg-gray-700"},{default:n(()=>[r.currentStatus==="pending"?(i(),p(s(c),{key:0,class:"w-12"},{default:n(()=>[e("input",{type:"checkbox",checked:o.value.length===r.posts.data.length,onChange:A,class:"rounded border-gray-300 dark:border-gray-600"},null,40,ce)]),_:1})):v("",!0),l(s(c),null,{default:n(()=>t[6]||(t[6]=[u("帖子",-1)])),_:1,__:[6]}),l(s(c),null,{default:n(()=>t[7]||(t[7]=[u("作者",-1)])),_:1,__:[7]}),l(s(c),null,{default:n(()=>t[8]||(t[8]=[u("分类",-1)])),_:1,__:[8]}),l(s(c),null,{default:n(()=>t[9]||(t[9]=[u("媒体",-1)])),_:1,__:[9]}),l(s(c),null,{default:n(()=>t[10]||(t[10]=[u("状态",-1)])),_:1,__:[10]}),l(s(c),null,{default:n(()=>t[11]||(t[11]=[u("审核信息",-1)])),_:1,__:[11]}),l(s(c),null,{default:n(()=>t[12]||(t[12]=[u("操作",-1)])),_:1,__:[12]})]),_:1})]),_:1}),l(s(H),null,{default:n(()=>[(i(!0),g(k,null,C(r.posts.data,a=>(i(),p(s($),{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},{default:n(()=>[r.currentStatus==="pending"?(i(),p(s(m),{key:0},{default:n(()=>[e("input",{type:"checkbox",checked:o.value.includes(a.id),onChange:y=>E(a.id),class:"rounded border-gray-300 dark:border-gray-600"},null,40,me)]),_:2},1024)):v("",!0),l(s(m),null,{default:n(()=>[e("div",ve,[a.first_image?(i(),g("img",{key:0,src:a.first_image,alt:"",class:"w-16 h-16 object-cover rounded"},null,8,pe)):v("",!0),e("div",null,[e("div",fe,d(a.title),1),e("div",_e,d(w(a.created_at)),1)])])]),_:2},1024),l(s(m),null,{default:n(()=>[e("div",null,d(a.user.name),1),e("div",ye,d(a.user.email),1)]),_:2},1024),l(s(m),null,{default:n(()=>[l(s(S),{variant:"outline"},{default:n(()=>[u(d(a.category.name),1)]),_:2},1024)]),_:2},1024),l(s(m),null,{default:n(()=>[e("div",be,[u(d(a.images_count)+" 图片 ",1),t[13]||(t[13]=e("br",null,null,-1)),u(" "+d(a.videos_count)+" 视频 ",1)])]),_:2},1024),l(s(m),null,{default:n(()=>[l(s(S),{class:b(F(a.review_status))},{default:n(()=>[u(d(a.review_status==="pending"?"待审核":a.review_status==="approved"?"已批准":"已拒绝"),1)]),_:2},1032,["class"])]),_:2},1024),l(s(m),null,{default:n(()=>[a.reviewer?(i(),g("div",xe,[e("div",null,d(a.reviewer.name),1),e("div",ke,d(w(a.reviewed_at)),1)])):(i(),g("div",he,"-"))]),_:2},1024),l(s(m),null,{default:n(()=>[e("div",we,[l(s(_),{size:"sm",variant:"outline",onClick:y=>N(a.id)},{default:n(()=>[l(s(K),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),a.review_status==="pending"?(i(),p(s(_),{key:0,size:"sm",onClick:y=>P(a.id),class:"bg-green-600 hover:bg-green-700 text-white"},{default:n(()=>[l(s(j),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):v("",!0),a.review_status==="pending"?(i(),p(s(_),{key:1,size:"sm",onClick:y=>V(a.id),class:"bg-red-600 hover:bg-red-700 text-white"},{default:n(()=>[l(s(z),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):v("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):(i(),g("div",Ce,t[14]||(t[14]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"没有找到帖子",-1)]))),r.posts.last_page>1?(i(),g("div",Se,[(i(!0),g(k,null,C(r.posts.last_page,a=>(i(),p(s(_),{key:a,size:"sm",variant:a===r.posts.current_page?"default":"outline",onClick:y=>s(f).get("/admin/post-reviews",{status:r.currentStatus,page:a})},{default:n(()=>[u(d(a),1)]),_:2},1032,["variant","onClick"]))),128))])):v("",!0)])])])])]),_:1})],64))}});export{Ze as default};
