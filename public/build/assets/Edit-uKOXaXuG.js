import{d as z,u as M,r as V,c as N,o as n,w as a,a as l,b as r,e,h as R,f as d,g as D,i as u,j as p,n as y,t as c,k as w,F as P,l as E,v as F,m as C,p as q}from"./app-fQ1uHLAv.js";import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-BJ0FV2gA.js";import{_ as v}from"./index-DOqB-uia.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-491R26qu.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-D_nXAQgU.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-CDvhHSW8.js";import{_ as T}from"./Card.vue_vue_type_script_setup_true_lang-DP-AvMeC.js";import{_ as X}from"./CardContent.vue_vue_type_script_setup_true_lang-C3RZLHJS.js";import{_ as G}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVUV8WXG.js";import{_ as H}from"./CardHeader.vue_vue_type_script_setup_true_lang-CIB-sEAo.js";import{_ as J}from"./CardTitle.vue_vue_type_script_setup_true_lang-CfvbPLLx.js";import{A as K}from"./arrow-left-BMUb771Y.js";import{X as U}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-DT3FpzxL.js";import"./Primitive-SQ216M94.js";import"./useForwardExpose-_bNHtLbu.js";import"./usePrimitiveElement-BAl1j9Je.js";import"./RovingFocusGroup-Bk8NGMpu.js";import"./VisuallyHidden-BZjHGUhc.js";import"./index-s5yllnis.js";import"./createLucideIcon-5gv4zljX.js";import"./DialogTitle-zHcWgUmM.js";import"./index-hb5zdG9_.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B6bSDjXn.js";import"./shield-DKYKPd_d.js";import"./trending-up-Ua6LM9pt.js";import"./file-text-ByfMAv8n.js";import"./chevron-right-DYder0Ze.js";import"./useArrowNavigation-C6Y-ieo6.js";const Q={class:"py-12"},W={class:"w-full sm:px-6 lg:px-8"},Y={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},Z={class:"p-6 text-gray-900 dark:text-gray-100"},ee={class:"mb-6 flex items-center justify-between"},te={class:"flex items-center gap-4"},se={class:"space-y-2"},re={key:0,class:"text-sm text-red-500"},oe={class:"space-y-2"},le={key:0,class:"text-sm text-red-500"},ae={class:"space-y-2"},de={key:0,class:"text-sm text-red-500"},ie={class:"space-y-2"},ne=["value"],ue={class:"text-sm text-gray-500 dark:text-gray-400"},ce={key:0},_e={key:1,class:"text-orange-500"},me={key:0,class:"text-sm text-red-500"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge={class:"space-y-2"},ye={class:"flex gap-2"},fe={key:0,class:"text-sm text-red-500"},ve={class:"space-y-2"},xe={key:0,class:"text-sm text-red-500"},be={class:"space-y-2"},ke={class:"flex items-start gap-4"},we={key:0,class:"relative"},he=["src"],Ve={class:"flex-1"},Ce={key:0,class:"text-sm text-red-500 mt-1"},Ue={class:"space-y-2"},$e={class:"flex items-start gap-4"},Ie={key:0,class:"relative"},Le=["src"],Be={class:"flex-1"},Se={key:0,class:"text-sm text-red-500 mt-1"},je={class:"space-y-2"},ze={key:0,class:"text-sm text-red-500"},Me={class:"flex items-center space-x-2"},Ne={class:"space-y-4"},Re={class:"flex items-center space-x-2"},De={key:0,class:"space-y-2 pl-6"},Pe={key:0,class:"text-sm text-red-500"},Ee={class:"space-y-2"},Fe={class:"space-y-2"},qe={class:"flex items-center space-x-2"},Ae=["checked"],Oe={class:"flex items-center space-x-2"},Te=["checked","disabled"],Xe={class:"flex items-center space-x-2"},Ge=["checked","disabled"],He={class:"flex items-center space-x-2"},Je=["checked","disabled"],Ke={key:0,class:"text-sm text-red-500"},Qe={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},We={class:"text-sm text-gray-600 dark:text-gray-400 space-y-1"},Ye={class:"font-semibold"},Ze={class:"flex gap-4"},It=z({__name:"Edit",props:{category:{},availableParents:{}},setup($){const m=$,s=M({name:m.category.name,slug:m.category.slug,description:m.category.description||"",color:m.category.color,icon:m.category.icon||"",icon_image:null,category_image:null,remove_icon_image:!1,remove_category_image:!1,sort_order:m.category.sort_order,is_active:m.category.is_active,is_nav_item:m.category.is_nav_item,nav_route:m.category.nav_route||"",allowed_user_types:m.category.allowed_user_types||["all"],parent_id:m.category.parent_id}),x=V(m.category.icon_image?`/storage/${m.category.icon_image}`:null),b=V(m.category.category_image?`/storage/${m.category.category_image}`:null),I=i=>{const o=i.target.files?.[0];o&&(s.icon_image=o,s.remove_icon_image=!1,x.value=URL.createObjectURL(o))},L=i=>{const o=i.target.files?.[0];o&&(s.category_image=o,s.remove_category_image=!1,b.value=URL.createObjectURL(o))},B=()=>{s.icon_image=null,s.remove_icon_image=!0,x.value=null;const i=document.getElementById("icon_image");i&&(i.value="")},S=()=>{s.category_image=null,s.remove_category_image=!0,b.value=null;const i=document.getElementById("category_image");i&&(i.value="")},j=()=>{s.transform(i=>({...i,_method:"PUT"})).post(`/admin/categories/${m.category.id}`,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{}})},h=()=>{q.visit("/admin/categories")};return(i,t)=>(n(),N(A,null,{default:a(()=>[l(e(R),{title:`编辑分类 - ${i.category.name}`},null,8,["title"]),r("div",Q,[r("div",W,[r("div",Y,[r("div",Z,[r("div",ee,[r("div",te,[l(e(v),{variant:"outline",size:"icon",onClick:h},{default:a(()=>[l(e(K),{class:"h-4 w-4"})]),_:1}),t[15]||(t[15]=r("h1",{class:"text-2xl font-semibold"},"编辑分类",-1))])]),l(e(T),null,{default:a(()=>[l(e(H),null,{default:a(()=>[l(e(J),null,{default:a(()=>t[16]||(t[16]=[d("分类信息",-1)])),_:1,__:[16]}),l(e(G),null,{default:a(()=>t[17]||(t[17]=[d(" 编辑分类的基本信息和设置 ",-1)])),_:1,__:[17]})]),_:1}),l(e(X),null,{default:a(()=>[r("form",{onSubmit:D(j,["prevent"]),class:"space-y-6"},[r("div",se,[l(e(_),{for:"name"},{default:a(()=>t[18]||(t[18]=[d("分类名称 *",-1)])),_:1,__:[18]}),l(e(f),{id:"name",modelValue:e(s).name,"onUpdate:modelValue":t[0]||(t[0]=o=>e(s).name=o),type:"text",required:"",class:y({"border-red-500":e(s).errors.name})},null,8,["modelValue","class"]),e(s).errors.name?(n(),u("p",re,c(e(s).errors.name),1)):p("",!0)]),r("div",oe,[l(e(_),{for:"slug"},{default:a(()=>t[19]||(t[19]=[d("别名 (URL) *",-1)])),_:1,__:[19]}),l(e(f),{id:"slug",modelValue:e(s).slug,"onUpdate:modelValue":t[1]||(t[1]=o=>e(s).slug=o),type:"text",required:"",placeholder:"category-slug",class:y({"border-red-500":e(s).errors.slug})},null,8,["modelValue","class"]),t[20]||(t[20]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 用于URL的唯一标识符，只能包含小写字母、数字和连字符 ",-1)),e(s).errors.slug?(n(),u("p",le,c(e(s).errors.slug),1)):p("",!0)]),r("div",ae,[l(e(_),{for:"description"},{default:a(()=>t[21]||(t[21]=[d("描述",-1)])),_:1,__:[21]}),l(O,{id:"description",modelValue:e(s).description,"onUpdate:modelValue":t[2]||(t[2]=o=>e(s).description=o),rows:"3",placeholder:"分类描述...",class:y({"border-red-500":e(s).errors.description})},null,8,["modelValue","class"]),e(s).errors.description?(n(),u("p",de,c(e(s).errors.description),1)):p("",!0)]),r("div",ie,[l(e(_),{for:"parent_id"},{default:a(()=>t[22]||(t[22]=[d("父分类",-1)])),_:1,__:[22]}),w(r("select",{id:"parent_id","onUpdate:modelValue":t[3]||(t[3]=o=>e(s).parent_id=o),class:y(["flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-red-500":e(s).errors.parent_id}])},[t[23]||(t[23]=r("option",{value:null},"无 (顶级分类)",-1)),(n(!0),u(P,null,E(i.availableParents,o=>(n(),u("option",{key:o.id,value:o.id},c(o.name),9,ne))),128))],2),[[F,e(s).parent_id]]),r("p",ue,[t[24]||(t[24]=d(" 当前分类 ",-1)),i.category.parent?(n(),u("span",ce,"(父分类: "+c(i.category.parent.name)+")",1)):p("",!0),i.category.children&&i.category.children.length>0?(n(),u("span",_e," · 此分类有 "+c(i.category.children.length)+" 个子分类 ",1)):p("",!0)]),e(s).errors.parent_id?(n(),u("p",me,c(e(s).errors.parent_id),1)):p("",!0)]),r("div",pe,[r("div",ge,[l(e(_),{for:"color"},{default:a(()=>t[25]||(t[25]=[d("颜色",-1)])),_:1,__:[25]}),r("div",ye,[l(e(f),{id:"color",modelValue:e(s).color,"onUpdate:modelValue":t[4]||(t[4]=o=>e(s).color=o),type:"color",class:y(["w-20 h-10 p-1 cursor-pointer",{"border-red-500":e(s).errors.color}])},null,8,["modelValue","class"]),l(e(f),{modelValue:e(s).color,"onUpdate:modelValue":t[5]||(t[5]=o=>e(s).color=o),type:"text",placeholder:"#3b82f6",class:y(["flex-1",{"border-red-500":e(s).errors.color}])},null,8,["modelValue","class"])]),e(s).errors.color?(n(),u("p",fe,c(e(s).errors.color),1)):p("",!0)]),r("div",ve,[l(e(_),{for:"icon"},{default:a(()=>t[26]||(t[26]=[d("图标类名",-1)])),_:1,__:[26]}),l(e(f),{id:"icon",modelValue:e(s).icon,"onUpdate:modelValue":t[6]||(t[6]=o=>e(s).icon=o),type:"text",placeholder:"lucide-icon-name",class:y({"border-red-500":e(s).errors.icon})},null,8,["modelValue","class"]),t[27]||(t[27]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 图标类名或标识符 ",-1)),e(s).errors.icon?(n(),u("p",xe,c(e(s).errors.icon),1)):p("",!0)])]),r("div",be,[l(e(_),{for:"icon_image"},{default:a(()=>t[28]||(t[28]=[d("图标图片",-1)])),_:1,__:[28]}),r("div",ke,[x.value?(n(),u("div",we,[r("img",{src:x.value,alt:"Icon preview",class:"w-24 h-24 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,he),l(e(v),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:B},{default:a(()=>[l(e(U),{class:"h-4 w-4"})]),_:1})])):p("",!0),r("div",Ve,[l(e(f),{id:"icon_image",type:"file",accept:"image/*",onChange:I,class:y({"border-red-500":e(s).errors.icon_image})},null,8,["class"]),t[29]||(t[29]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 200x200px, 最大 2MB ",-1)),e(s).errors.icon_image?(n(),u("p",Ce,c(e(s).errors.icon_image),1)):p("",!0)])])]),r("div",Ue,[l(e(_),{for:"category_image"},{default:a(()=>t[30]||(t[30]=[d("分类封面图",-1)])),_:1,__:[30]}),r("div",$e,[b.value?(n(),u("div",Ie,[r("img",{src:b.value,alt:"Category preview",class:"w-48 h-32 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,Le),l(e(v),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:S},{default:a(()=>[l(e(U),{class:"h-4 w-4"})]),_:1})])):p("",!0),r("div",Be,[l(e(f),{id:"category_image",type:"file",accept:"image/*",onChange:L,class:y({"border-red-500":e(s).errors.category_image})},null,8,["class"]),t[31]||(t[31]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 800x600px, 最大 5MB ",-1)),e(s).errors.category_image?(n(),u("p",Se,c(e(s).errors.category_image),1)):p("",!0)])])]),r("div",je,[l(e(_),{for:"sort_order"},{default:a(()=>t[32]||(t[32]=[d("排序顺序",-1)])),_:1,__:[32]}),l(e(f),{id:"sort_order",modelValue:e(s).sort_order,"onUpdate:modelValue":t[7]||(t[7]=o=>e(s).sort_order=o),modelModifiers:{number:!0},type:"number",class:y({"border-red-500":e(s).errors.sort_order})},null,8,["modelValue","class"]),t[33]||(t[33]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 数字越小排序越靠前 ",-1)),e(s).errors.sort_order?(n(),u("p",ze,c(e(s).errors.sort_order),1)):p("",!0)]),r("div",Me,[w(r("input",{id:"is_active","onUpdate:modelValue":t[8]||(t[8]=o=>e(s).is_active=o),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[C,e(s).is_active]]),l(e(_),{for:"is_active",class:"cursor-pointer"},{default:a(()=>t[34]||(t[34]=[d(" 启用分类 ",-1)])),_:1,__:[34]})]),r("div",Ne,[r("div",Re,[w(r("input",{id:"is_nav_item","onUpdate:modelValue":t[9]||(t[9]=o=>e(s).is_nav_item=o),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[C,e(s).is_nav_item]]),l(e(_),{for:"is_nav_item",class:"cursor-pointer"},{default:a(()=>t[35]||(t[35]=[d(" 显示在导航菜单 ",-1)])),_:1,__:[35]})]),e(s).is_nav_item?(n(),u("div",De,[l(e(_),{for:"nav_route"},{default:a(()=>t[36]||(t[36]=[d("导航路由",-1)])),_:1,__:[36]}),l(e(f),{id:"nav_route",modelValue:e(s).nav_route,"onUpdate:modelValue":t[10]||(t[10]=o=>e(s).nav_route=o),type:"text",placeholder:"/category/slug",class:y({"border-red-500":e(s).errors.nav_route})},null,8,["modelValue","class"]),t[37]||(t[37]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 导航菜单中的链接地址 ",-1)),e(s).errors.nav_route?(n(),u("p",Pe,c(e(s).errors.nav_route),1)):p("",!0)])):p("",!0)]),r("div",Ee,[l(e(_),null,{default:a(()=>t[38]||(t[38]=[d("允许发帖的用户类型",-1)])),_:1,__:[38]}),r("div",Fe,[r("div",qe,[r("input",{id:"type_all",type:"checkbox",value:"all",checked:e(s).allowed_user_types.includes("all"),onChange:t[11]||(t[11]=o=>{o.target.checked?e(s).allowed_user_types=["all"]:e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="all")}),class:"rounded"},null,40,Ae),l(e(_),{for:"type_all",class:"cursor-pointer"},{default:a(()=>t[39]||(t[39]=[d("所有用户",-1)])),_:1,__:[39]})]),r("div",Oe,[r("input",{id:"type_creator",type:"checkbox",value:"creator",checked:e(s).allowed_user_types.includes("creator"),disabled:e(s).allowed_user_types.includes("all"),onChange:t[12]||(t[12]=o=>{o.target.checked?(e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="all"),e(s).allowed_user_types.push("creator")):e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="creator")}),class:"rounded"},null,40,Te),l(e(_),{for:"type_creator",class:"cursor-pointer"},{default:a(()=>t[40]||(t[40]=[d("仅创作者",-1)])),_:1,__:[40]})]),r("div",Xe,[r("input",{id:"type_regular",type:"checkbox",value:"regular",checked:e(s).allowed_user_types.includes("regular"),disabled:e(s).allowed_user_types.includes("all"),onChange:t[13]||(t[13]=o=>{o.target.checked?(e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="all"),e(s).allowed_user_types.push("regular")):e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="regular")}),class:"rounded"},null,40,Ge),l(e(_),{for:"type_regular",class:"cursor-pointer"},{default:a(()=>t[41]||(t[41]=[d("仅普通用户",-1)])),_:1,__:[41]})]),r("div",He,[r("input",{id:"type_admin",type:"checkbox",value:"admin",checked:e(s).allowed_user_types.includes("admin"),disabled:e(s).allowed_user_types.includes("all"),onChange:t[14]||(t[14]=o=>{o.target.checked?(e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="all"),e(s).allowed_user_types.push("admin")):e(s).allowed_user_types=e(s).allowed_user_types.filter(g=>g!=="admin")}),class:"rounded"},null,40,Je),l(e(_),{for:"type_admin",class:"cursor-pointer"},{default:a(()=>t[42]||(t[42]=[d("仅管理员",-1)])),_:1,__:[42]})])]),t[43]||(t[43]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 选择哪些类型的用户可以在此分类下发帖。管理员始终可以发帖。 ",-1)),e(s).errors.allowed_user_types?(n(),u("p",Ke,c(e(s).errors.allowed_user_types),1)):p("",!0)]),r("div",Qe,[t[45]||(t[45]=r("h3",{class:"text-sm font-medium mb-2"},"分类统计",-1)),r("div",We,[r("p",null,[t[44]||(t[44]=d("关联帖子数: ",-1)),r("span",Ye,c(i.category.posts_count),1)]),r("p",null,"创建时间: "+c(new Date(i.category.created_at).toLocaleString("zh-CN")),1),r("p",null,"更新时间: "+c(new Date(i.category.updated_at).toLocaleString("zh-CN")),1)])]),r("div",Ze,[l(e(v),{type:"submit",disabled:e(s).processing},{default:a(()=>[d(c(e(s).processing?"保存中...":"保存更改"),1)]),_:1},8,["disabled"]),l(e(v),{type:"button",variant:"outline",onClick:h},{default:a(()=>t[46]||(t[46]=[d(" 取消 ",-1)])),_:1,__:[46]})])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{It as default};
