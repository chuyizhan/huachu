import{d as N,u as R,r as h,c as S,o as u,w as a,a as o,b as r,e,h as D,f as d,g as M,i as p,j as g,n as y,t as _,k as V,v as C,l as E}from"./app-Fsc2fWeG.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-BRLOr3JF.js";import{_ as v}from"./index-BvqcHxZ0.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-C-CnsAdF.js";import{_ as n}from"./Label.vue_vue_type_script_setup_true_lang-BQSEKwK9.js";import{_ as q}from"./Textarea.vue_vue_type_script_setup_true_lang-CoDgYkX7.js";import{_ as A}from"./Card.vue_vue_type_script_setup_true_lang-DFKRuGmr.js";import{_ as F}from"./CardContent.vue_vue_type_script_setup_true_lang-Xltpq-ge.js";import{_ as O}from"./CardDescription.vue_vue_type_script_setup_true_lang-Cqq8K_XS.js";import{_ as T}from"./CardHeader.vue_vue_type_script_setup_true_lang-DfyxhswC.js";import{_ as X}from"./CardTitle.vue_vue_type_script_setup_true_lang-BlYHS2HI.js";import{A as G}from"./arrow-left-BQta4w27.js";import{X as U}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-DKE0KELH.js";import"./Primitive-DzJzFL7l.js";import"./useForwardExpose-CDTa1s8D.js";import"./usePrimitiveElement-CGXoSR73.js";import"./RovingFocusGroup-DOcz2L7-.js";import"./VisuallyHidden-C8uwcRnc.js";import"./index-CYQTJ8jh.js";import"./createLucideIcon-Cxns02P7.js";import"./DialogTitle-CbE85AY6.js";import"./index-hb5zdG9_.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D2-Ic_NX.js";import"./shield-WBi95os_.js";import"./trending-up-MndDfiGd.js";import"./file-text-BGDH-V6V.js";import"./chevron-right-K-pnYNJJ.js";import"./useArrowNavigation-C6Y-ieo6.js";const H={class:"py-12"},J={class:"w-full sm:px-6 lg:px-8"},K={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},Q={class:"p-6 text-gray-900 dark:text-gray-100"},W={class:"mb-6 flex items-center justify-between"},Y={class:"flex items-center gap-4"},Z={class:"space-y-2"},ee={key:0,class:"text-sm text-red-500"},se={class:"space-y-2"},te={key:0,class:"text-sm text-red-500"},re={class:"space-y-2"},oe={key:0,class:"text-sm text-red-500"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ae={class:"space-y-2"},de={class:"flex gap-2"},ie={key:0,class:"text-sm text-red-500"},ne={class:"space-y-2"},ce={key:0,class:"text-sm text-red-500"},ue={class:"space-y-2"},_e={class:"flex items-start gap-4"},me={key:0,class:"relative"},pe=["src"],ge={class:"flex-1"},ye={key:0,class:"text-sm text-red-500 mt-1"},fe={class:"space-y-2"},ve={class:"flex items-start gap-4"},xe={key:0,class:"relative"},be=["src"],ke={class:"flex-1"},we={key:0,class:"text-sm text-red-500 mt-1"},he={class:"space-y-2"},Ve={key:0,class:"text-sm text-red-500"},Ce={class:"flex items-center space-x-2"},Ue={class:"space-y-4"},$e={class:"flex items-center space-x-2"},Ie={key:0,class:"space-y-2 pl-6"},Be={key:0,class:"text-sm text-red-500"},Le={class:"space-y-2"},je={class:"space-y-2"},ze={class:"flex items-center space-x-2"},Ne=["checked"],Re={class:"flex items-center space-x-2"},Se=["checked","disabled"],De={class:"flex items-center space-x-2"},Me=["checked","disabled"],Ee={class:"flex items-center space-x-2"},Pe=["checked","disabled"],qe={key:0,class:"text-sm text-red-500"},Ae={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},Fe={class:"text-sm text-gray-600 dark:text-gray-400 space-y-1"},Oe={class:"font-semibold"},Te={class:"flex gap-4"},xs=N({__name:"Edit",props:{category:{}},setup($){const c=$,t=R({name:c.category.name,slug:c.category.slug,description:c.category.description||"",color:c.category.color,icon:c.category.icon||"",icon_image:null,category_image:null,remove_icon_image:!1,remove_category_image:!1,sort_order:c.category.sort_order,is_active:c.category.is_active,is_nav_item:c.category.is_nav_item,nav_route:c.category.nav_route||"",allowed_user_types:c.category.allowed_user_types||["all"]}),x=h(c.category.icon_image?`/storage/${c.category.icon_image}`:null),b=h(c.category.category_image?`/storage/${c.category.category_image}`:null),I=i=>{const l=i.target.files?.[0];l&&(t.icon_image=l,t.remove_icon_image=!1,x.value=URL.createObjectURL(l))},B=i=>{const l=i.target.files?.[0];l&&(t.category_image=l,t.remove_category_image=!1,b.value=URL.createObjectURL(l))},L=()=>{t.icon_image=null,t.remove_icon_image=!0,x.value=null;const i=document.getElementById("icon_image");i&&(i.value="")},j=()=>{t.category_image=null,t.remove_category_image=!0,b.value=null;const i=document.getElementById("category_image");i&&(i.value="")},z=()=>{t.transform(i=>({...i,_method:"PUT"})).post(`/admin/categories/${c.category.id}`,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{}})},w=()=>{E.visit("/admin/categories")};return(i,s)=>(u(),S(P,null,{default:a(()=>[o(e(D),{title:`编辑分类 - ${i.category.name}`},null,8,["title"]),r("div",H,[r("div",J,[r("div",K,[r("div",Q,[r("div",W,[r("div",Y,[o(e(v),{variant:"outline",size:"icon",onClick:w},{default:a(()=>[o(e(G),{class:"h-4 w-4"})]),_:1}),s[14]||(s[14]=r("h1",{class:"text-2xl font-semibold"},"编辑分类",-1))])]),o(e(A),null,{default:a(()=>[o(e(T),null,{default:a(()=>[o(e(X),null,{default:a(()=>s[15]||(s[15]=[d("分类信息",-1)])),_:1,__:[15]}),o(e(O),null,{default:a(()=>s[16]||(s[16]=[d(" 编辑分类的基本信息和设置 ",-1)])),_:1,__:[16]})]),_:1}),o(e(F),null,{default:a(()=>[r("form",{onSubmit:M(z,["prevent"]),class:"space-y-6"},[r("div",Z,[o(e(n),{for:"name"},{default:a(()=>s[17]||(s[17]=[d("分类名称 *",-1)])),_:1,__:[17]}),o(e(f),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=l=>e(t).name=l),type:"text",required:"",class:y({"border-red-500":e(t).errors.name})},null,8,["modelValue","class"]),e(t).errors.name?(u(),p("p",ee,_(e(t).errors.name),1)):g("",!0)]),r("div",se,[o(e(n),{for:"slug"},{default:a(()=>s[18]||(s[18]=[d("别名 (URL) *",-1)])),_:1,__:[18]}),o(e(f),{id:"slug",modelValue:e(t).slug,"onUpdate:modelValue":s[1]||(s[1]=l=>e(t).slug=l),type:"text",required:"",placeholder:"category-slug",class:y({"border-red-500":e(t).errors.slug})},null,8,["modelValue","class"]),s[19]||(s[19]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 用于URL的唯一标识符，只能包含小写字母、数字和连字符 ",-1)),e(t).errors.slug?(u(),p("p",te,_(e(t).errors.slug),1)):g("",!0)]),r("div",re,[o(e(n),{for:"description"},{default:a(()=>s[20]||(s[20]=[d("描述",-1)])),_:1,__:[20]}),o(q,{id:"description",modelValue:e(t).description,"onUpdate:modelValue":s[2]||(s[2]=l=>e(t).description=l),rows:"3",placeholder:"分类描述...",class:y({"border-red-500":e(t).errors.description})},null,8,["modelValue","class"]),e(t).errors.description?(u(),p("p",oe,_(e(t).errors.description),1)):g("",!0)]),r("div",le,[r("div",ae,[o(e(n),{for:"color"},{default:a(()=>s[21]||(s[21]=[d("颜色",-1)])),_:1,__:[21]}),r("div",de,[o(e(f),{id:"color",modelValue:e(t).color,"onUpdate:modelValue":s[3]||(s[3]=l=>e(t).color=l),type:"color",class:y(["w-20 h-10 p-1 cursor-pointer",{"border-red-500":e(t).errors.color}])},null,8,["modelValue","class"]),o(e(f),{modelValue:e(t).color,"onUpdate:modelValue":s[4]||(s[4]=l=>e(t).color=l),type:"text",placeholder:"#3b82f6",class:y(["flex-1",{"border-red-500":e(t).errors.color}])},null,8,["modelValue","class"])]),e(t).errors.color?(u(),p("p",ie,_(e(t).errors.color),1)):g("",!0)]),r("div",ne,[o(e(n),{for:"icon"},{default:a(()=>s[22]||(s[22]=[d("图标类名",-1)])),_:1,__:[22]}),o(e(f),{id:"icon",modelValue:e(t).icon,"onUpdate:modelValue":s[5]||(s[5]=l=>e(t).icon=l),type:"text",placeholder:"lucide-icon-name",class:y({"border-red-500":e(t).errors.icon})},null,8,["modelValue","class"]),s[23]||(s[23]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 图标类名或标识符 ",-1)),e(t).errors.icon?(u(),p("p",ce,_(e(t).errors.icon),1)):g("",!0)])]),r("div",ue,[o(e(n),{for:"icon_image"},{default:a(()=>s[24]||(s[24]=[d("图标图片",-1)])),_:1,__:[24]}),r("div",_e,[x.value?(u(),p("div",me,[r("img",{src:x.value,alt:"Icon preview",class:"w-24 h-24 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,pe),o(e(v),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:L},{default:a(()=>[o(e(U),{class:"h-4 w-4"})]),_:1})])):g("",!0),r("div",ge,[o(e(f),{id:"icon_image",type:"file",accept:"image/*",onChange:I,class:y({"border-red-500":e(t).errors.icon_image})},null,8,["class"]),s[25]||(s[25]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 200x200px, 最大 2MB ",-1)),e(t).errors.icon_image?(u(),p("p",ye,_(e(t).errors.icon_image),1)):g("",!0)])])]),r("div",fe,[o(e(n),{for:"category_image"},{default:a(()=>s[26]||(s[26]=[d("分类封面图",-1)])),_:1,__:[26]}),r("div",ve,[b.value?(u(),p("div",xe,[r("img",{src:b.value,alt:"Category preview",class:"w-48 h-32 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700"},null,8,be),o(e(v),{type:"button",variant:"destructive",size:"icon",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full",onClick:j},{default:a(()=>[o(e(U),{class:"h-4 w-4"})]),_:1})])):g("",!0),r("div",ke,[o(e(f),{id:"category_image",type:"file",accept:"image/*",onChange:B,class:y({"border-red-500":e(t).errors.category_image})},null,8,["class"]),s[27]||(s[27]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 推荐尺寸: 800x600px, 最大 5MB ",-1)),e(t).errors.category_image?(u(),p("p",we,_(e(t).errors.category_image),1)):g("",!0)])])]),r("div",he,[o(e(n),{for:"sort_order"},{default:a(()=>s[28]||(s[28]=[d("排序顺序",-1)])),_:1,__:[28]}),o(e(f),{id:"sort_order",modelValue:e(t).sort_order,"onUpdate:modelValue":s[6]||(s[6]=l=>e(t).sort_order=l),modelModifiers:{number:!0},type:"number",class:y({"border-red-500":e(t).errors.sort_order})},null,8,["modelValue","class"]),s[29]||(s[29]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 数字越小排序越靠前 ",-1)),e(t).errors.sort_order?(u(),p("p",Ve,_(e(t).errors.sort_order),1)):g("",!0)]),r("div",Ce,[V(r("input",{id:"is_active","onUpdate:modelValue":s[7]||(s[7]=l=>e(t).is_active=l),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[C,e(t).is_active]]),o(e(n),{for:"is_active",class:"cursor-pointer"},{default:a(()=>s[30]||(s[30]=[d(" 启用分类 ",-1)])),_:1,__:[30]})]),r("div",Ue,[r("div",$e,[V(r("input",{id:"is_nav_item","onUpdate:modelValue":s[8]||(s[8]=l=>e(t).is_nav_item=l),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[C,e(t).is_nav_item]]),o(e(n),{for:"is_nav_item",class:"cursor-pointer"},{default:a(()=>s[31]||(s[31]=[d(" 显示在导航菜单 ",-1)])),_:1,__:[31]})]),e(t).is_nav_item?(u(),p("div",Ie,[o(e(n),{for:"nav_route"},{default:a(()=>s[32]||(s[32]=[d("导航路由",-1)])),_:1,__:[32]}),o(e(f),{id:"nav_route",modelValue:e(t).nav_route,"onUpdate:modelValue":s[9]||(s[9]=l=>e(t).nav_route=l),type:"text",placeholder:"/category/slug",class:y({"border-red-500":e(t).errors.nav_route})},null,8,["modelValue","class"]),s[33]||(s[33]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 导航菜单中的链接地址 ",-1)),e(t).errors.nav_route?(u(),p("p",Be,_(e(t).errors.nav_route),1)):g("",!0)])):g("",!0)]),r("div",Le,[o(e(n),null,{default:a(()=>s[34]||(s[34]=[d("允许发帖的用户类型",-1)])),_:1,__:[34]}),r("div",je,[r("div",ze,[r("input",{id:"type_all",type:"checkbox",value:"all",checked:e(t).allowed_user_types.includes("all"),onChange:s[10]||(s[10]=l=>{l.target.checked?e(t).allowed_user_types=["all"]:e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="all")}),class:"rounded"},null,40,Ne),o(e(n),{for:"type_all",class:"cursor-pointer"},{default:a(()=>s[35]||(s[35]=[d("所有用户",-1)])),_:1,__:[35]})]),r("div",Re,[r("input",{id:"type_creator",type:"checkbox",value:"creator",checked:e(t).allowed_user_types.includes("creator"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[11]||(s[11]=l=>{l.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="all"),e(t).allowed_user_types.push("creator")):e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="creator")}),class:"rounded"},null,40,Se),o(e(n),{for:"type_creator",class:"cursor-pointer"},{default:a(()=>s[36]||(s[36]=[d("仅创作者",-1)])),_:1,__:[36]})]),r("div",De,[r("input",{id:"type_regular",type:"checkbox",value:"regular",checked:e(t).allowed_user_types.includes("regular"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[12]||(s[12]=l=>{l.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="all"),e(t).allowed_user_types.push("regular")):e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="regular")}),class:"rounded"},null,40,Me),o(e(n),{for:"type_regular",class:"cursor-pointer"},{default:a(()=>s[37]||(s[37]=[d("仅普通用户",-1)])),_:1,__:[37]})]),r("div",Ee,[r("input",{id:"type_admin",type:"checkbox",value:"admin",checked:e(t).allowed_user_types.includes("admin"),disabled:e(t).allowed_user_types.includes("all"),onChange:s[13]||(s[13]=l=>{l.target.checked?(e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="all"),e(t).allowed_user_types.push("admin")):e(t).allowed_user_types=e(t).allowed_user_types.filter(m=>m!=="admin")}),class:"rounded"},null,40,Pe),o(e(n),{for:"type_admin",class:"cursor-pointer"},{default:a(()=>s[38]||(s[38]=[d("仅管理员",-1)])),_:1,__:[38]})])]),s[39]||(s[39]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 选择哪些类型的用户可以在此分类下发帖。管理员始终可以发帖。 ",-1)),e(t).errors.allowed_user_types?(u(),p("p",qe,_(e(t).errors.allowed_user_types),1)):g("",!0)]),r("div",Ae,[s[41]||(s[41]=r("h3",{class:"text-sm font-medium mb-2"},"分类统计",-1)),r("div",Fe,[r("p",null,[s[40]||(s[40]=d("关联帖子数: ",-1)),r("span",Oe,_(i.category.posts_count),1)]),r("p",null,"创建时间: "+_(new Date(i.category.created_at).toLocaleString("zh-CN")),1),r("p",null,"更新时间: "+_(new Date(i.category.updated_at).toLocaleString("zh-CN")),1)])]),r("div",Te,[o(e(v),{type:"submit",disabled:e(t).processing},{default:a(()=>[d(_(e(t).processing?"保存中...":"保存更改"),1)]),_:1},8,["disabled"]),o(e(v),{type:"button",variant:"outline",onClick:w},{default:a(()=>s[42]||(s[42]=[d(" 取消 ",-1)])),_:1,__:[42]})])],32)]),_:1})]),_:1})])])])])]),_:1}))}});export{xs as default};
